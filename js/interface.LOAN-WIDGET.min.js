/*
 Copyright 2016 Pine Grove Software, LLC
 financial-calculators.com
 pine-grove.com
 common.LIB.js
*/
var inputType,LIB$=function(){var a={ERR_MSGS:{noDelKey:"Please use the backspace key to delete.",noCurKeys:"Left, up & down arrow keys are disabled. So are the home, end, pgup and pgdn keys.\n\nUse backspace to delete.\n\nIf value is selected, just start typing new value to clear prior value.\n\nWhen a number is selected (value shown in inverse), use right arrow key to clear selection without clearing value. Then backspace to edit.\n\nTIP: Generally it is best to use the TAB or SHIFT-TAB keys to move from one input to the next or previous input.\n\nTIP 2: Generally, editing a value is inefficient. Since values are auto selected, just type the number you want.",
noSeparators:"Do not type the thousand separator character.\n\n(If using US convention, that would be the comma.)\n\nI'm smart enough to enter them for you!"}},d=Error("An unknown date calculation error occured.\nPlease provide us with your inputs and settings so that we can fix this. Thank you."),G=Error("Date is not valid - bad year.");a.zoomLevel=1;a.AMORT_MTHD={AM_NORMAL:0,AM_CANADIAN:1,AM_RULE_OF_78S:2,AM_USRULE:3};a.CANADIAN_ODD_DAYS={STRAIGHT_LINE:0,COMPOUNDED:1};a.CASH_FLOW_TYPE={CF_DEBT:0,
CF_SAVINGS:1};a.CCY_FORMATS={USD1:0,USD2:1,GBH:2,NON:3,EUR1:4,EUR2:5,EUR3:6,EUR4:7};a.CCY_CONVENTIONS=[{sep:",",dPnt:".",ccy:"$",ccy_r:""},{sep:".",dPnt:",",ccy:"$",ccy_r:""},{sep:",",dPnt:".",ccy:"\u00a3",ccy_r:""},{sep:",",dPnt:".",ccy:"",ccy_r:""},{sep:",",dPnt:".",ccy:"\u20ac",ccy_r:""},{sep:".",dPnt:",",ccy:"\u20ac",ccy_r:""},{sep:" ",dPnt:",",ccy:"",ccy_r:"\u20ac"},{sep:".",dPnt:",",ccy:"",ccy_r:"\u20ac"}];a.DATE_FORMATS={MDY:0,DMY:1,YMD:2};a.DATE_FORMAT_STRS=["MM/DD/YYYY","DD/MM/YYYY","YYYY-MM-DD"];
a.DATE_CONVENTIONS=[{date_mask:"MM/DD/YYYY",date_sep:"/",sep_pos1:2,sep_pos2:5},{date_mask:"DD/MM/YYYY",date_sep:"/",sep_pos1:2,sep_pos2:5},{date_mask:"YYYY-MM-DD",date_sep:"-",sep_pos1:4,sep_pos2:7}];a.ROW_TYPES={DETAIL:0,ANNUAL_TOTALS:1,RUNNING_TOTALS:2};a.DAYS_IN_YEAR={THREE_SIXTY:0,THREE_SIXTY_FOUR:1,THREE_SIXTY_FIVE:2,THREE_SIXTY_SIXTY:3};a.PMT_METHOD={ARREARS:0,ADVANCE:1};a.UNKNOWN={TOO_MANY:-1,NOTHING:0,PV:1,PERIODS:2,R:3,PMT:4,FV:5,BALLOON:6};a.PMT_FREQUENCY={DAILY:1,WEEKLY:2,BIWEEKLY:3,TWICEMONTHLY:4,
EVERY4WKS:5,MONTHLY:6,BIMONTHLY:7,QUARTERLY:8,EVERY4MONTHS:9,SEMIANNUALLY:10,ANNUALLY:11};a.CMP_FREQUENCY={CONTINUOUS:0,DAILY:1,WEEKLY:2,BIWEEKLY:3,TWICEMONTHLY:4,EVERY4WKS:5,MONTHLY:6,BIMONTHLY:7,QUARTERLY:8,EVERY4MONTHS:9,SEMIANNUALLY:10,ANNUALLY:11,EXACT:12,NONE:13};a.CPPPP=[[null,1,7,14,15.5,28,30.5,61,91.5,122,182.5,362.5],[null,1,7,14,15.5,28,30.5,61,91.5,122,182.5,362.5],[null,null,1,2,null,4,null,null,null,null,26,52],[null,null,null,1,null,2,null,null,null,null,13,26],[null,null,null,null,
1,null,2,4,6,8,12,24],[null,null,null,null,null,1,null,null,null,null,6.5,13],[null,null,null,null,null,null,1,2,3,4,6,12],[null,null,null,null,null,null,null,1,null,null,3,6],[null,null,null,null,null,null,null,null,1,null,2,4],[null,null,null,null,null,null,null,null,null,1,1.5,3],[null,null,null,null,null,null,1/6,null,null,null,1,2],[null,null,null,null,null,null,1/12,null,null,null,null,1],[null,1,7,14,15.5,28,30.5,61,91.5,122,182.5,362.5],[null,1,7,14,15.5,28,30.5,61,91.5,122,182.5,362.5]];
a.STR_FREQUENCIES="Continuous;Daily;Weekly;BiWeekly;Twice Monthly;Every 4 Weeks;Monthly;BiMonthly;Quarterly;Every 4 Months;Semiannually;Annually;Exact/Simple;None".split(";");a.CURRENCIES={EUR:"\u20ac",GBP:"\u00a3",INR:"\u20a8",JPY:"\u00a5",KPW:"\u20a9",USD:"$"};a.INITIAL_PERIOD_TYPE={SHORT:0,REGULAR:1,LONG:2};a.LONG_INTEREST_PMT_MTHD={NONE:0,WITHORIGINATION:1,WITHFIRST:2,AMORTIZED:3};a.ROUNDING_METHOD={RMLASTPMT:0,RMIGNORE:1,RMOPENBALANCE:2};a.SHORT_INTEREST_PMT_MTHD={NOREDUCTION:0,REDUCEFIRST:1,
REDUCEALL:2};a.POINTS_PAID_METHOD={OFFSCHEDULE:0,WITHORIGINATION:1};a.SPECIAL_SERIES_TYPES={SS_NORMAL:0,SS_INTEREST_ONLY:1,SS_FIXED_PRINCIPAL:2,SS_EXISTING_FIXED:3,SS_PRINCIPAL_FIRST:4,SS_AMOUNT_STEP:5,SS_PCT_STEP:6,SS_SKIP_SERIES:7,SS_MONTH_SKIP:8,SS_MIN_PMT:9};a.CASH_EVENTS={EV_RATE:0,EV_CREDIT:1,EV_DEBIT:2};a.EMPTY_STR="";a.PCT="%";a.US_DECIMAL=".";a.MONTHS="Jan Feb Mar Apr May Jun Jul Aug Sept Oct Nov Dec".split(" ");a.MIN_YEAR=1970;a.MIN_DATE=new Date(a.MIN_YEAR,0,1,0,0,0,0);a.MAX_YEAR=2099;
a.MAX_DATE=new Date(a.MAX_YEAR,11,31,0,0,0,0);a.INITIAL_CASH_FLOWS=500;a.DIY=a.DAYS_IN_YEAR.THREE_SIXTY;a.DAYS_PER_YEAR=[360,364,365,366];a.PPY=[360,360,52,26,24,13,12,6,4,3,2,1,360];a.MPF=[-1,0,0,0,0,0,1,2,3,4,6,12,-1];a.DPF=[-1,1,7,14,-1,28,-1,-1,-1,-1,-1,-1,-1];a.DPF78s=[-1,1,7,14,15,28,30,60,90,120,180,365,-1];a.DPF_APR=[-1,1,7,14,15,28,30,60,90,120,180,360,-1];a.ONE_DAY=864E5;a.DAYS_PER_WEEK=7;a.LIPM=a.LONG_INTEREST_PMT_MTHD.AMORTIZED;a.SIPM=a.SHORT_INTEREST_PMT_MTHD.REDUCEALL;a.UNKNOWN_STR=
"Unknown";a.displayExceptionMsg=function(a){alert(a)};a.print_calc=function(){window.print()};a.call_Print=function(a){document.getElementById(a).contentWindow.printContent()};a.call_Print2=function(a){a=parent.document.getElementById(a);try{a.contentWindow.document.execCommand("print",!1,null)}catch(k){a.contentWindow.print()}return!1};a.focusSelect=function(a){a.onfocus=function(){a.select();a.onmouseup=function(){a.onmouseup=null;return!1}}};a.stripCharsInBag=function(a,k){var g,l,c="";for(g=0;g<
a.length;g+=1)l=a.charAt(g),-1===k.indexOf(l)&&(c+=l);return c};a.StringBuffer=function(){this.buffer=[]};a.StringBuffer.prototype.append=function(a){this.buffer.push(a);return this};a.StringBuffer.prototype.toString=function(){return this.buffer.join("")};a.LocalConventions=function(e){e||(e=a.CCY_FORMATS.USD1);this.ccy_format=e;this.sep=a.CCY_CONVENTIONS[e].sep;this.dPnt=a.CCY_CONVENTIONS[e].dPnt;this.ccy=a.CCY_CONVENTIONS[e].ccy;this.ccy_r=a.CCY_CONVENTIONS[e].ccy_r};a.LocalConventions.prototype.numConvention=
function(){var e=new a.LocalConventions(this.ccy_format);e.ccy="";e.ccy_r="";return e};a.LocalConventions.prototype.rateConvention=function(){var e=new a.LocalConventions(this.ccy_format);e.ccy="";e.ccy_r="%";return e};a.LocalDateConventions=function(e){e&&null!==e||(e=a.DATE_FORMATS.MDY);this.date_format=e;this.date_mask=a.DATE_CONVENTIONS[e].date_mask;this.date_sep=a.DATE_CONVENTIONS[e].date_sep;this.sep_pos1=a.DATE_CONVENTIONS[e].sep_pos1;this.sep_pos2=a.DATE_CONVENTIONS[e].sep_pos2};a.dateNow=
new Date;a.yearNow=a.dateNow.getFullYear().toString();a.monthNowName=a.MONTHS[a.dateNow.getMonth()];a.monthNow=("0"+(a.dateNow.getMonth()+1)).slice(-2);a.dayNow="01";a.pmt_method=a.PMT_METHOD.ARREARS;a.pmt_frequency=a.PMT_FREQUENCY.MONTHLY;a.cmp_frequency=a.CMP_FREQUENCY.MONTHLY;a.ppy=a.PPY[a.pmt_frequency];a.cmpPPY=a.PPY[a.cmp_frequency];a.moneyConventions=new a.LocalConventions;a.rateConventions=a.moneyConventions.rateConvention();a.numConventions=a.moneyConventions.numConvention();a.resetNumConventions=
function(e){e!==a.moneyConventions.ccy_format&&(a.moneyConventions=new a.LocalConventions(parseInt(Cookies.get("ccy_format"),10)),a.rateConventions=a.moneyConventions.rateConvention(),a.numConventions=a.moneyConventions.numConvention(),Cookies.set("ccy_format",parseInt(e,10),{expires:Infinity}))};a.dateConventions=new a.LocalDateConventions;a.sortConventions=new a.LocalDateConventions(a.DATE_FORMATS.YMD);a.resetDateConventions=function(e){e!==a.dateConventions.date_format&&(a.dateConventions=new a.LocalDateConventions(e),
Cookies.set("date_format",parseInt(e,10),{expires:Infinity}))};a.evenRound=function(a,k){var g=k||0,l=Math.pow(10,g),c=+(g?a*l:a).toFixed(8),D=Math.floor(c),d=c-D,c=.49999999<d&&.50000001>d?0===D%2?D:D+1:Math.round(c);return g?c/l:c};a.roundMoney=function(e,k,g){var l=Math.pow(10,k||2);return void 0===e||null===e||"number"!==typeof e?"":void 0!==g&&g?a.evenRound(e,k):Math.round(e*l)/l};a.addSeparators=function(a,k,g,l){var c=a.indexOf(g),D=/(\d+)(\d{3})/,d="",u;for(u=0;u<a.length;u+=1)a.charAt(u)!==
k&&(d+=a.charAt(u));if(-1===c&&0<l){for(;1<d.length&&"0"===d.charAt(0)||"-"===d.charAt(0)&&2<d.length&&"0"===d.charAt(1);)d=d.substr(1,d.length-1);for(;D.test(d);)d=d.replace(D,"$1"+k+"$2");return d}if(-1===c&&0===l){for(;D.test(d);)d=d.replace(D,"$1"+k+"$2");return d}for(a=d.split(g);D.test(a[0]);)a[0]=a[0].replace(D,"$1"+k+"$2");return 0!==l&&a[1].length<=l?a[0]+g+a[1]:0!==l?a[0]+g+a[1].substr(0,l):a[0]};a.getLocalNumStr=function(e,k){if(null===e)return"";var g=e+a.EMPTY_STR;k!==a.US_DECIMAL&&(g=
g.replace(/\./,k));return g};a.formatFloat=function(e,k,g,d){e=a.getLocalNumStr(e,g);var c=e.indexOf(g);if(null===e||0===e.length)return a.EMPTY_STR;-1===c&&0!==d&&(e+=g,c=e.length-1);for(;e.length-1-c<d&&0<d;)e+="0";return a.addSeparators(e,k,g,d)};a.formatLocalFloat=function(e,k,g,d){e=a.getLocalNumStr(e,k.dPnt);var c=e.indexOf(k.dPnt);d=void 0!==d?d:100;if(null===e||0===e.length)return a.EMPTY_STR;if("u"===e.charAt(0)||"U"===e.charAt(0))return a.UNKNOWN_STR;-1===c&&0!==g&&(e+=k.dPnt,c=e.length-
1);if(0<g)for(;e.length-1-c<g;)e+="0";e=a.addSeparators(e,k.sep,k.dPnt,g);""!==k.ccy&&e.charAt(0)!==k.ccy&&e.length<d?e=k.ccy+e:""!==k.ccy_r&&e.charAt(e.length-1)!==k.ccy_r&&e.length<d&&(e+=k.ccy_r);return e};a.getUSNumStr=function(e,k,g,d,c){e!==a.UNKNOWN_STR?(k="."!==k?k:"\\.",e=e.replace(""!==d?new RegExp("\\"+d+"|"+d+"|"+k,"g"):new RegExp("\\"+c+"|"+c+"|"+k,"g"),a.EMPTY_STR),g!==a.US_DECIMAL&&(e=e.replace(g,a.US_DECIMAL)),e.charAt(e.length-1)===a.PCT&&(e=e.slice(0,-1))):e="0";return e};a.getUSNum=
function(e,k,g){e=a.getUSNumStr(e,k.sep,k.dPnt,k.ccy,k.ccy_r);return g?parseFloat(e):parseInt(e,10)};var u=function(e,k,g,d){this.isValid=!1;this.element=document.getElementById(e);null!==this.element&&(this.id=e,this.conventions=k&&null!==k?k:a.moneyConventions,this.ccy_format=k.ccy_format,this.precision=void 0!==g?g:2,this.sep=k.sep,this.dPnt=k.dPnt,this.ccy=k.ccy,this.ccy_r=k.ccy_r,this.PCT="%",this.customTouchEndHandler=this.customMouseUpHandler=this.customKeyDownHandler=this.customKeyPressHandler=
this.customBlurHandler=null,this.UNKNOWN_STR=a.UNKNOWN_STR,this.isTableEditor=d||!1,this.init(),this.isValid=!0,this.isTableEditor&&(""!==this.element.value&&this.element.value!==a.UNKNOWN_STR&&(e=a.getUSNum(this.element.value,this.conventions,this.precision),this.element.value=a.formatLocalFloat(e,this.conventions,this.precision,this.element.maxLength)),this.element.selectionStart?(this.element.selectionStart=0,this.element.selectionEnd=this.element.value.length):this.element.select()))};a.NE=u;
u.prototype.initRateEditor=function(){this.ccy="";this.ccy_r="%"};u.prototype.initNumEditor=function(){this.ccy_r=this.ccy=""};u.prototype.addEvent=function(a,k,g){var d;"function"===typeof window.addEventListener?(d=function(a){k.call(g,a)},this.element.addEventListener(a,d,!1)):(d=function(a){k.call(g,window.event)},this.element.attachEvent("on"+a,d));return d};u.prototype.init=function(){this.isTableEditor||(this.customBlurHandler=this.addEvent("blur",this.onCustomBlur,this));this.customKeyPressHandler=
this.addEvent("keypress",this.onCustomKeyPress,this);this.customKeyDownHandler=this.addEvent("keydown",this.onCustomKeyDown,this);this.customMouseUpHandler=this.addEvent("mouseup",this.onCustomMouseUp,this);this.customTouchEndHandler=this.addEvent("touchend",this.onCustomMouseUp,this)};u.prototype.removeEvent=function(a,k){"function"===typeof window.addEventListener?this.element.removeEventListener(a,k,!1):this.element.detachEvent("on"+a,k)};u.prototype.destroy=function(){this.removeEvent("mouseup",
this.customMouseUpHandler);this.removeEvent("touchend",this.customMouseUpHandler);this.customTouchEndHandler=this.customMouseUpHandler=null;this.removeEvent("keydown",this.customKeyDownHandler);this.customKeyDownHandler=null;this.removeEvent("keypress",this.customKeyPressHandler);this.customKeyPressHandler=null;this.isTableEditor||(this.removeEvent("blur",this.customBlurHandler),this.customBlurHandler=null);this.element=null};u.prototype.onCustomKeyDown=function(e){return 46===e.keyCode?(e.preventDefault(),
alert(a.ERR_MSGS.noDelKey),!1):37===e.keyCode||33===e.keyCode||34===e.keyCode||35===e.keyCode||36===e.keyCode||38===e.keyCode||40===e.keyCode?(this.isTableEditor||alert(a.ERR_MSGS.noCurKeys),e.preventDefault?e.preventDefault():e.returnValue=!1,!1):188===e.keyCode&&","===this.sep||(110===e.keyCode||190===e.keyCode)&&"."===this.sep||32===e.keyCode&&" "===this.sep?(alert(a.ERR_MSGS.noSeparators),e.preventDefault?e.preventDefault():e.returnValue=!1,!1):!0};u.prototype.onCustomKeyPress=function(e){var k,
g,d,c=!1,c="";d=0<=this.element.value.indexOf(this.dPnt);k=null;if(e.which)c=0!==this.element.selectionEnd-this.element.selectionStart,k=e.which;else if(window.event)k=document.selection.createRange(),c=""!==k.text,k=e.keyCode;else return 37===e.keyCode||33===e.keyCode||34===e.keyCode||35===e.keyCode||36===e.keyCode?(e.preventDefault?e.preventDefault():e.returnValue=!1,!1):!0;g=String.fromCharCode(k);if((d=/\d|u|U/.test(g)||8===k||g===this.dPnt&&!d&&0<this.precision||45===k&&(0===this.element.value.length||
c))&&!c&&8!==k&&this.element.value.length<this.element.maxLength&&85!==k&&117!==k)c=a.addSeparators(this.element.value+g,this.sep,this.dPnt,this.precision),45===k?this.element.value="":1<c.length&&this.element.value!==this.UNKNOWN_STR?this.element.value=c.substr(0,c.length-1):(this.element.value=g,d=!1);else if(85===k||117===k)this.element.value=this.UNKNOWN_STR,d=!1;d||(e.preventDefault?e.preventDefault():e.returnValue=!1);return d};u.prototype.onCustomBlur=function(e){if(0===this.element.value.length)this.element.value=
0;else if(this.element.value===a.UNKNOWN_STR)return;this.element.value=a.formatLocalFloat(a.getUSNum(this.element.value,this.conventions,this.precision),this.conventions,this.precision,this.element.maxLength);return!0};u.prototype.onCustomMouseUp=function(a){a.preventDefault?(this.element.selectionStart=0,this.element.selectionEnd=this.element.value.length,a.preventDefault()):(this.element.select(),a.returnValue=!1);return!1};u.prototype.setValue=function(e){this.element.value=a.formatLocalFloat(e,
this.conventions,this.precision,this.element.maxLength)};u.prototype.getUSNumber=function(){var e=a.getUSNumStr(this.element.value,this.sep,this.dPnt,this.ccy,this.ccy_r);return 0!==this.precision?parseFloat(e):parseInt(e,10)};a.calcRates={effectiveRate:function(e,k,d,l){if(void 0===k||null===k)k=a.pmt_frequency;if(void 0===d||null===d)d=a.cmp_frequency;if(void 0===l||null===l)l=a.DIY;l=360===l||364===l||365===l||366===l?l:a.DAYS_PER_YEAR[l];return d>a.CMP_FREQUENCY.DAILY&&d<a.CMP_FREQUENCY.EXACT?
a.PPY[k]*Math.pow(1+e/a.PPY[d],a.PPY[d]/a.PPY[k])-a.PPY[k]:d===a.CMP_FREQUENCY.DAILY||d===a.CMP_FREQUENCY.EXACT?a.PPY[k]*Math.pow(1+e/l,l/a.PPY[k])-a.PPY[k]:d===a.CMP_FREQUENCY.CONTINUOUS?Math.exp(e)-1:-1},nominalRate:function(e,k,d,l){if(void 0===k||null===k)k=a.pmt_frequency;if(void 0===d||null===d)d=a.cmp_frequency;if(void 0===l||null===l)l=a.DIY;l=360===l||364===l||365===l||366===l?l:a.DAYS_PER_YEAR[l];return d>a.CMP_FREQUENCY.DAILY&&d<a.CMP_FREQUENCY.EXACT?a.PPY[d]*Math.pow(1+e/a.PPY[k],a.PPY[k]/
a.PPY[d])-a.PPY[d]:d===a.CMP_FREQUENCY.DAILY||d===a.CMP_FREQUENCY.EXACT?l*Math.pow(1+e/a.PPY[k],a.PPY[k]/l)-l:d===a.CMP_FREQUENCY.CONTINUOUS?Math.log(1+e):-1},blendedRate:function(e,k,d,l){var c;c=0;if(void 0===k||null===k)k=a.pmt_frequency;if(void 0===d||null===d)d=a.cmp_frequency;if(void 0===l||null===l)l=a.DIY;c=360===l||364===l||365===l||366===l?l:a.DAYS_PER_YEAR[l];l=e/c;c=d<=k&&d>a.CMP_FREQUENCY.DAILY&&d<a.CMP_FREQUENCY.EXACT?e/a.PPY[d]:d>k&&d>a.CMP_FREQUENCY.DAILY&&d<a.CMP_FREQUENCY.EXACT?
a.calcRates.effectiveRate(e,k,d,c)/a.PPY[k]:d===a.CMP_FREQUENCY.CONTINUOUS||d===a.CMP_FREQUENCY.DAILY||d===a.CMP_FREQUENCY.EXACT?l:null;return[c,l]}};a.dateMath=function(){var e=new Date,k=0,g=0,l=0,c=[31,28,31,30,31,30,31,31,30,31,30,31],D=!1,u=!1,B=!1,E={days:null,periods:null,oddDays:null},h=function(a){return 0===a%4},f=function(a){return h(a)?29:c[1]},H=function(a){return 1!==a.getMonth()?a.getDate()===c[a.getMonth()]:a.getDate()===f(a.getFullYear())},L=function(a){return 1!==a.getMonth()?c[a.getMonth()]:
f(a.getFullYear())},v=function(a,c){a.setDate(a.getDate()+c);return a.getTime()},q=function(a,c){var e=a.getDate();a.setMonth(a.getMonth()+c);a.getDate()!==e&&(a.setDate(0),B&&30!==a.getDate()&&1!==a.getMonth()?a.setDate(30):u&&29!==a.getDate()&&1!==a.getMonth()&&a.setDate(29));D&&!H(a)?a.setDate(L(a)):B&&30!==a.getDate()&&1!==a.getMonth()?a.setDate(30):u&&29!==a.getDate()&&1!==a.getMonth()&&a.setDate(29);return a.getTime()},P=function(c,e,f){var d=new Date;d.setTime(c.getTime());d.setHours(0,0,0,
0);switch(f){case a.PMT_FREQUENCY.DAILY:v(d,e);break;case a.PMT_FREQUENCY.WEEKLY:v(d,e*a.DPF[f]);break;case a.PMT_FREQUENCY.BIWEEKLY:v(d,e*a.DPF[f]);break;case a.PMT_FREQUENCY.TWICEMONTHLY:c=e;if(0<=c)for(e=0;e<c;e+=1)15!==d.getDate()||B&&1!==d.getMonth()?15===d.getDate()&&B?d.setDate(30):H(d)&&1!==d.getMonth()||H(d)&&1===d.getMonth()&&D?(d.setDate(15),d.setMonth(d.getMonth()+1)):H(d)&&1===d.getMonth()&&!B?(d.setDate(14),d.setMonth(d.getMonth()+1)):H(d)&&1===d.getMonth()?(d.setDate(15),d.setMonth(d.getMonth()+
1)):15>d.getDate()&&(1!==d.getMonth()||1===d.getMonth()&&h(d.getFullYear())||1===d.getMonth()&&14>d.getDate())?v(d,15):1===d.getMonth()&&14===d.getDate()?v(d,14):15<d.getDate()&&(v(d,-15),d.setMonth(d.getMonth()+1)):d.setDate(L(d));else for(c=Math.abs(c),e=0;e<c;e+=1)15!==d.getDate()||B&&2!==d.getMonth()?15===d.getDate()&&B?(d.setMonth(d.getMonth()-1),d.setDate(30)):H(d)||30===d.getDate()?d.setDate(15):15<d.getDate()&&30>d.getDate()?v(d,-15):15>d.getDate()&&2!==d.getMonth()?(d.setMonth(d.getMonth()-
1),v(d,15)):15>d.getDate()&&(d.setMonth(d.getMonth()-1),14===d.getDate()?d.setDate(L(d)):v(d,15)):(d.setMonth(d.getMonth()-1),d.setDate(L(d)));d.getTime();break;case a.PMT_FREQUENCY.EVERY4WKS:v(d,e*a.DPF[f]);break;case a.PMT_FREQUENCY.MONTHLY:q(d,e);break;case a.PMT_FREQUENCY.BIMONTHLY:q(d,e*a.MPF[f]);break;case a.PMT_FREQUENCY.QUARTERLY:q(d,e*a.MPF[f]);break;case a.PMT_FREQUENCY.EVERY4MONTHS:q(d,e*a.MPF[f]);break;case a.PMT_FREQUENCY.SEMIANNUALLY:q(d,e*a.MPF[f]);break;case a.PMT_FREQUENCY.ANNUALLY:q(d,
e*a.MPF[f]);break;default:alert("Interal error. Can't add periods.")}return d.getTime()},I=function(e,c,d){var f=new Date,b=new Date;f.setTime(e.getTime());b.setTime(c.getTime());if(d>=a.PMT_FREQUENCY.MONTHLY)return alert("Error: not a week based frequency."),!1;if(f.getTime()>b.getTime())return alert("Error: dates out of sequenct."),!1;k=Math.round((b.getTime()-f.getTime())/a.ONE_DAY);g=Math.floor(Math.floor(k)/a.DPF[d]);l=k%a.DPF[d];return!0},C=function(e,c,f){var h=new Date,b=new Date,M=new Date,
S=0;b.setTime(e.getTime());M.setTime(c.getTime());if(f<a.PMT_FREQUENCY.MONTHLY)return alert("Error: not a month based frequency."),!1;k=Math.round((M.getTime()-b.getTime())/a.ONE_DAY);do if(g+=1,h.setTime(M.getTime()),M.setTime(q(M,-1*a.MPF[f])),S+=1,1E4===S)throw d;while(M.getTime()>b.getTime()&&1E4>S);M.getTime()<b.getTime()&&(--g,M.setTime(h.getTime()),l=Math.round((M.getTime()-b.getTime())/a.ONE_DAY));return!0},K=function(e,c,d){var f=!0;if(1>c||12<c||isNaN(c))f=!1;if(e<a.MIN_YEAR||e>a.MAX_YEAR||
isNaN(e))f=!1;if((9===c||4===c||6===c||11===c)&&(1>d||30<d))f=!1;else if(2===c){if(!h(e)&&(1>d||28<d)||29<d)f=!1}else if(1>d||31<d||isNaN(d))f=!1;return f};return{addPeriods:P,setRefDate:function(c,d){e.setTime(c.getTime());e.setHours(0,0,0,0);D=H(e)||d===a.PMT_FREQUENCY.TWICEMONTHLY&&(15===e.getDate()||31===e.getDate());u=!D&&29===e.getDate();B=!D&&30===e.getDate();D&&e.getMonth()},countPeriods:function(e,c,f){l=g=k=0;if(e.getTime()>c.getTime())return alert("Error: dates out of sequence."),!1;if(e.getTime()===
c.getTime())return E.days=k,E.periods=g,E.oddDays=l,E;switch(f){case a.PMT_FREQUENCY.DAILY:g=k=Math.round((c.getTime()-e.getTime())/a.ONE_DAY);l=0;break;case a.PMT_FREQUENCY.WEEKLY:I(e,c,f);break;case a.PMT_FREQUENCY.BIWEEKLY:I(e,c,f);break;case a.PMT_FREQUENCY.TWICEMONTHLY:var u=new Date,b=new Date,M=0;u.setTime(e.getTime());b.setTime(c.getTime());if(f!==a.PMT_FREQUENCY.TWICEMONTHLY)alert("Error: not twice monthly frequency.");else{k=Math.round((b.getTime()-u.getTime())/a.ONE_DAY);do if(g+=1,15!==
b.getDate()||B&&2!==b.getMonth()?15===b.getDate()&&B?(b.setMonth(b.getMonth()-1),b.setDate(30)):H(b)&&1!==b.getMonth()||H(b)&&1===b.getMonth()&&(D||B)?b.setDate(15):H(b)&&1===b.getMonth()?b.setDate(14):15>b.getDate()&&(2!==b.getMonth()||2===b.getMonth()&&h(b.getFullYear())||2===b.getMonth()&&14>b.getDate())?(b.setMonth(b.getMonth()-1),v(b,15)):2===b.getMonth()&&14===b.getDate()?(v(b,14),b.setMonth(b.getMonth()-1)):15<b.getDate()&&v(b,-15):(b.setMonth(b.getMonth()-1),b.setDate(L(b))),M+=1,1E4===M)throw d;
while(b.getTime()>u.getTime()&&1E4>M);b.getTime()<u.getTime()&&(--g,b.setTime(P(b,1,f)),l=Math.round((b.getTime()-u.getTime())/a.ONE_DAY))}break;case a.PMT_FREQUENCY.EVERY4WKS:I(e,c,f);break;case a.PMT_FREQUENCY.MONTHLY:C(e,c,f);break;case a.PMT_FREQUENCY.BIMONTHLY:C(e,c,f);break;case a.PMT_FREQUENCY.QUARTERLY:C(e,c,f);break;case a.PMT_FREQUENCY.EVERY4MONTHS:C(e,c,f);break;case a.PMT_FREQUENCY.SEMIANNUALLY:C(e,c,f);break;case a.PMT_FREQUENCY.ANNUALLY:C(e,c,f);break;default:alert("Internal error. Undefined frequency.")}E.days=
k;E.periods=g;E.oddDays=l;return E},isValidDate:K,dateStrToDate:function(e,c){var d,f;d=[];var b=[],M=new Date;c?(f=c.date_format,d=c.date_sep):(f=a.dateConventions.date_format,d=a.dateConventions.date_sep);d=e.split(d);b[0]=parseInt(d[0],10);b[1]=parseInt(d[1],10);b[2]=parseInt(d[2],10);switch(f){case a.DATE_FORMATS.MDY:K(b[2],b[0],b[1])&&(M=new Date(b[2],b[0]-1,b[1],0,0,0,0));break;case a.DATE_FORMATS.DMY:K(b[2],b[1],b[0])&&(M=new Date(b[2],b[1]-1,b[0],0,0,0,0));break;case a.DATE_FORMATS.YMD:K(b[0],
b[1],b[2])&&(M=new Date(b[0],b[1]-1,b[2],0,0,0,0))}return M},dateToDateStr:function(e,c){var d,f,b,M,S,p=e.getFullYear();if(p<a.MIN_YEAR||p>a.MAX_YEAR)throw G;c?(f=c.date_format,d=c.date_sep):(f=a.dateConventions.date_format,d=a.dateConventions.date_sep);S=("0"+(e.getMonth()+1)).slice(-2);M=("0"+e.getDate()).slice(-2);switch(f){case a.DATE_FORMATS.MDY:b=S+d+M+d+p;break;case a.DATE_FORMATS.DMY:b=M+d+S+d+p;break;case a.DATE_FORMATS.YMD:b=p+d+S+d+M}return b},getLastDay:L,getFirstNextMonth:function(a){return new Date(a.getFullYear(),
a.getMonth()+1)},isLeapYear:h}}();u=function(e,d,g,l){this.isValid=!1;this.element=document.getElementById(e);null!==this.element&&(this.id=e,this.sep_pos2=this.sep_pos1=this.date_sep=this.date_mask=this.date_format=null,this.isValidKey=!0,d&&null!==d?(e=new a.LocalDateConventions(d),this.date_mask=e.date_mask,this.date_sep=e.date_sep,this.sep_pos1=e.sep_pos1,this.sep_pos2=e.sep_pos2):(this.date_mask=a.dateConventions.date_mask,this.date_sep=a.dateConventions.date_sep,this.sep_pos1=a.dateConventions.sep_pos1,
this.sep_pos2=a.dateConventions.sep_pos2),this.customTouchEndHandler=this.customMouseUpHandler=this.customKeyUpHandler=this.customKeyDownHandler=this.customKeyPressHandler=this.customBlurHandler=null,this.isTableEditor=g||!1,this.init(),this.isValid=!0,this.isTableEditor&&this.element.selectionStart?(this.element.selectionStart=0,this.element.selectionEnd=this.element.value.length):this.isTableEditor&&this.element.select())};a.DE=u;u.prototype.addEvent=function(a,d,g){var l;"function"===typeof window.addEventListener?
(l=function(a){d.call(g,a)},this.element.addEventListener(a,l,!1)):(l=function(a){d.call(g,window.event)},this.element.attachEvent("on"+a,l));return l};u.prototype.resetConventions=function(e){var d,g=[],l,c=this.date_format,g=this.element.value.split(this.date_sep);e?this.date_format!==e&&(d=new a.LocalDateConventions(e),this.date_format=e,this.date_mask=d.date_mask,this.date_sep=d.date_sep,this.sep_pos1=d.sep_pos1,this.sep_pos2=d.sep_pos2):(this.date_format=a.dateConventions.date_format,this.date_mask=
a.dateConventions.date_mask,this.date_sep=a.dateConventions.date_sep,this.sep_pos1=a.dateConventions.sep_pos1,this.sep_pos2=a.dateConventions.sep_pos2);if(!e||this.date_format!==e){if(c===a.DATE_FORMATS.MDY)switch(e){case a.DATE_FORMATS.DMY:l=g[1]+this.date_sep+g[0]+this.date_sep+g[2];break;case a.DATE_FORMATS.YMD:l=g[2]+this.date_sep+g[0]+this.date_sep+g[1]}else if(c===a.DATE_FORMATS.DMY)switch(e){case a.DATE_FORMATS.MDY:l=g[1]+this.date_sep+g[0]+this.date_sep+g[2];break;case a.DATE_FORMATS.YMD:l=
g[2]+this.date_sep+g[1]+this.date_sep+g[0]}else switch(e){case a.DATE_FORMATS.MDY:l=g[1]+this.date_sep+g[2]+this.date_sep+g[0];break;case a.DATE_FORMATS.DMY:l=g[2]+this.date_sep+g[1]+this.date_sep+g[0]}this.element.value=l}};u.prototype.init=function(){this.isTableEditor||(this.customBlurHandler=this.addEvent("blur",this.onCustomBlur,this));this.customKeyDownHandler=this.addEvent("keydown",this.onCustomKeyDown,this);this.customKeyUpHandler=this.addEvent("keyup",this.onCustomKeyUp,this);this.customMouseUpHandler=
this.addEvent("mouseup",this.onCustomMouseUp,this);this.customTouchEndHandler=this.addEvent("touchend",this.onCustomMouseUp,this)};u.prototype.setValue=function(e){this.element.value=a.dateMath.dateToDateStr(e)};u.prototype.getDate=function(){return a.dateMath.dateStrToDate(this.element.value)};u.prototype.removeEvent=function(a,d){"function"===typeof window.addEventListener?this.element.removeEventListener(a,d,!1):this.element.detachEvent("on"+a,d)};u.prototype.destroy=function(){this.removeEvent("mouseup",
this.customMouseUpHandler);this.removeEvent("touchend",this.customMouseUpHandler);this.customTouchEndHandler=this.customMouseUpHandler=null;this.removeEvent("keyup",this.customKeyUpHandler);this.customKeyUpHandler=null;this.removeEvent("keydown",this.customKeyDownHandler);this.customKeyDownHandler=null;this.isTableEditor||(this.removeEvent("blur",this.customBlurHandler),this.customBlurHandler=null);this.element=null};u.prototype.onCustomKeyDown=function(a){var d;a.which?d=0!==this.element.selectionEnd-
this.element.selectionStart:window.event&&(d=document.selection.createRange(),d=""!==d.text);this.isValidKey=(48<=a.keyCode&&57>=a.keyCode||96<=a.keyCode&&105>=a.keyCode)&&(this.element.value.length<this.date_mask.length||d)&&this.element.value.length!==this.sep_pos1&&this.element.value.length!==this.sep_pos2||8===a.keyCode||9===a.keyCode||39===a.keyCode||65===a.keyCode&&a.ctrlKey;return this.isValidKey?!0:(46===a.keyCode?alert("Please use backspace to delete."):109!==a.keyCode&&111!==a.keyCode&&
189!==a.keyCode&&191!==a.keyCode||alert('There is no need to type the "'+this.date_sep+"\". I'll enter it for you.\n\nUse R Arrow to clear selection. Backspace to edit."),a.preventDefault?a.preventDefault():a.returnValue=!1,!1)};u.prototype.onCustomKeyUp=function(a){this.element.value.length!==this.sep_pos1&&this.element.value.length!==this.sep_pos2||8===a.keyCode||(this.element.value+=this.date_sep);return!0};u.prototype.onCustomBlur=function(e){var d,g,l,c,D=[],D=this.element.value.split(this.date_sep);
D[0]=parseInt(D[0],10);D[1]=parseInt(D[1],10);D[2]=parseInt(D[2],10);switch(this.date_mask){case "MM/DD/YYYY":d=D[0];g=D[1];l=D[2];c=a.monthNow+"/"+a.dayNow+"/"+a.yearNow;break;case "DD/MM/YYYY":g=D[0];d=D[1];l=D[2];c=a.dayNow+"/"+a.monthNow+"/"+a.yearNow;break;case "YYYY-MM-DD":l=D[0],d=D[1],g=D[2],c=a.yearNow+"-"+a.monthNow+"-"+a.dayNow}return!e||this.isValidKey&&a.dateMath.isValidDate(l,d,g)?!0:(e.preventDefault?e.preventDefault():e.returnValue=!1,this.element.value=c,this.isValidKey=!0,!1)};u.prototype.onCustomMouseUp=
function(a){a.preventDefault?(this.element.selectionStart=0,this.element.selectionEnd=this.element.value.length,a.preventDefault()):(this.element.select(),a.returnValue=!1);return!1};Cookies.get("ccy_format")||Cookies.get("date_format")?(a.moneyConventions=new a.LocalConventions(parseInt(Cookies.get("ccy_format"),10)),a.dateConventions=new a.LocalDateConventions(parseInt(Cookies.get("date_format"),10)),a.rateConventions=a.moneyConventions.rateConvention(),a.numConventions=a.moneyConventions.numConvention()):
Cookies.enabled&&Cookies.set("ccy_format",a.moneyConventions.ccy_format,{expires:Infinity}).set("date_format",a.dateConventions.date_format,{expires:Infinity});u=function(a){if(void 0===a||0===a)a=100;this.data=[];this.increment=a;this.size=0};a.Vector=u;a.Vector=u;u.prototype.getCapacity=function(){return this.data.length};u.prototype.getSize=function(){return this.size};u.prototype.isEmpty=function(){return 0===this.getSize()};u.prototype.getLastElement=function(){if(null!==this.data[this.getSize()-
1])return this.data[this.getSize()-1]};u.prototype.getFirstElement=function(){if(null!==this.data[0])return this.data[0]};u.prototype.getElementAt=function(a){try{return this.data[a]}catch(d){return"Exception "+d+" occured when accessing "+a}};u.prototype.addElement=function(a){this.data[this.size]=a;this.size+=1};u.prototype.insertElementAt=function(a,d){var g;try{this.size===this.getCapacity()&&this.resize();for(g=this.getSize();g>d;--g)this.data[g]=this.data[g-1];this.data[d]=a;this.size+=1}catch(l){return"Invalid index "+
g}};u.prototype.removeElementAt=function(a){var d,g;try{g=this.data[a];for(d=a;d<this.getSize()-1;d+=1)this.data[d]=this.data[d+1];this.data[this.getSize()-1]=null;--this.size;return g}catch(l){return"Invalid index "+a}};u.prototype.removeAllElements=function(){var a;for(a=this.size=0;a<this.data.length;a+=1)this.data[a]=null};u.prototype.indexOf=function(a){var d;for(d=0;d<this.getSize();d+=1)if(this.data[d]===a)return d;return-1};u.prototype.contains=function(a){var d;for(d=0;d<this.getSize();d+=
1)if(this.data[d]===a)return!0;return!1};u.prototype.resize=function(){var a,d=[];for(a=0;a<this.data.length;a+=1)d[a]=this.data[a];this.data=d};u.prototype.trimToSize=function(){var a,d=[];for(a=0;a<this.getSize();a+=1)d[a]=this.data[a];this.size=d.length;this.data=d};u.prototype.sort=function(a){var d,g,l,c,D;for(d=1;d<this.getSize();d+=1){c=this.data[d];l=c[a];g=d-1;D=this.data[g];for(D=D[a];0<=g&&D>l;)this.data[g+1]=this.data[g],--g,0<=g&&(D=this.data[g],D=D[a]);this.data[g+1]=c}};u.prototype.clone=
function(){var d,k=new a.Vector(this.size);for(d=0;d<this.size;d+=1)"function"===typeof this.data[d].clone?k.addElement(this.data[d].clone()):k.addElement(this.data[d]);return k};u.prototype.toString=function(){var a,d,g={},l="Vector Object properties:\nIncrement: "+this.increment+"\nSize: "+this.size+"\nElements:\n";for(a=0;a<this.getSize();a+=1)for(d in this.data[a])this.data[a].hasOwnProperty(d)&&(g=this.data[a],l+="\tObject."+d+" = "+g[d]+"\n");return l};u.prototype.overwriteElementAt=function(a,
d){this.data[d]=a};return a}();/*
 Copyright 2016 Pine Grove Software, LLC
 financial-calculators.com
 pine-grove.com
 equations.js
*/
var EQ$=function(a){function d(b){var c;J=K=c=0;L=b.oDate.valueOf()===b.fDate.valueOf()&&0===b.lDate.valueOf()&&b.cmpFreq===b.pmtFreq;b.oDate.valueOf()!==b.fDate.valueOf()&&(H.setTime(a.dateMath.addPeriods(b.fDate,-1,b.pmtFreq)),I=a.dateMath.countPeriods(b.oDate,b.fDate,b.pmtFreq),b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY&&(0===I.periods?(c=0,--C,I=a.dateMath.countPeriods(b.oDate,b.fDate,b.cmpFreq)):(c=1,I=a.dateMath.countPeriods(b.oDate,H,b.cmpFreq)),K=I.periods),J=I.oddDays,
L=b.oDate.valueOf()===H.valueOf()&&0===b.lDate.valueOf()&&b.cmpFreq===b.pmtFreq);return c}function G(b){v=b.nominalRate/b.daysPerYear;b.pmtFreq!==b.cmpFreq?b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?(q=(a.PPY[b.pmtFreq]*Math.pow(1+b.nominalRate/a.PPY[b.cmpFreq],a.PPY[b.cmpFreq]/a.PPY[b.pmtFreq])-a.PPY[b.pmtFreq])/a.PPY[b.pmtFreq],P=b.nominalRate/a.PPY[b.cmpFreq]):b.cmpFreq===a.CMP_FREQUENCY.DAILY||b.cmpFreq===a.CMP_FREQUENCY.EXACT?q=(a.PPY[b.pmtFreq]*Math.pow(1+b.nominalRate/
b.daysPerYear,b.daysPerYear/a.PPY[b.pmtFreq])-a.PPY[b.pmtFreq])/a.PPY[b.pmtFreq]:b.cmpFreq===a.CMP_FREQUENCY.CONTINUOUS&&(q=Math.exp(b.nominalRate)-1):q=b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?P=b.nominalRate/a.PPY[b.cmpFreq]:v}function u(a,c,d,e){var f;f=a;0<c&&(f=a+a*v*c);0<d&&(f*=Math.pow(1+P,d));0!==q&&(c=Math.pow(1+q,e),f*=c);return f-a}function e(b,c,d){return d!==a.CMP_FREQUENCY.EXACT&&d!==a.CMP_FREQUENCY.DAILY&&d!==a.CMP_FREQUENCY.CONTINUOUS?null:(d===a.CMP_FREQUENCY.EXACT?
b*(1+v*c):d===a.CMP_FREQUENCY.DAILY?b*Math.pow(1+v,c):b*Math.pow(2.718281828,v*c))-b}function k(b){var c,e;if(b.cmpFreq<a.CMP_FREQUENCY.WEEKLY||b.cmpFreq>a.CMP_FREQUENCY.ANNUALLY||null===b.n||0===b.oDate.valueOf()||0===b.fDate.valueOf()||b.oDate.valueOf()>b.fDate.valueOf()||null===b.pmtMthd||null===b.pmtFreq||null===b.cmpFreq)return null;I={days:0,periods:1,oddDays:0};J=K=0;G(b);C=b.n;d(b);e=b.pv+b.pv*v*J;e*=Math.pow(1+P,K);C!==b.n&&0!==b.cf&&(e+=b.cf);return 0!==q||0!==v?(c=Math.pow(1+q,C),e=e*c+
b.cf*(c-1)*(1+q*b.pmtMthd)/q):null}function g(b){var c,d,e,f=0,m=new Date(0),h=new Date(0);if(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY||null===b.n||0===b.oDate.valueOf()||0===b.fDate.valueOf()||b.oDate.valueOf()>b.fDate.valueOf()||null===b.pmtMthd||null===b.pmtFreq||null===b.cmpFreq)return null;G(b);if(0===b.cf&&b.cmpFreq!==a.CMP_FREQUENCY.EXACT||null===b.cf)return h.setTime(b.fDate.getTime()),b.pmtMthd===a.PMT_METHOD.ARREARS?h.setTime(a.dateMath.addPeriods(h,b.n-1,b.pmtFreq)):
h.setTime(a.dateMath.addPeriods(h,b.n,b.pmtFreq)),f=a.dateMath.countPeriods(b.oDate,h,b.pmtFreq).days,e=b.cmpFreq===a.CMP_FREQUENCY.EXACT?b.pv*(1+v*f):b.cmpFreq===a.CMP_FREQUENCY.DAILY?b.pv*Math.pow(1+v,f):b.pv*Math.pow(2.718281828,v*f);d=b.n;m.setTime(b.oDate.getTime());h.setTime(b.fDate.getTime());f=a.dateMath.countPeriods(m,h,b.pmtFreq).days;if(b.cmpFreq===a.CMP_FREQUENCY.EXACT){e=b.pv*(1+v*f)+b.cf;for(c=1;c<d;c+=1)m.setTime(h.getTime()),h.setTime(a.dateMath.addPeriods(m,1,b.pmtFreq)),f=a.dateMath.countPeriods(m,
h,b.pmtFreq).days,e=e*(1+v*f)+b.cf;b.pmtMthd===a.PMT_METHOD.ADVANCE&&(m.setTime(h.getTime()),h.setTime(a.dateMath.addPeriods(m,1,b.pmtFreq)),f=a.dateMath.countPeriods(m,h,b.pmtFreq).days,e*=1+v*f)}else if(b.cmpFreq===a.CMP_FREQUENCY.CONTINUOUS){e=b.pv*Math.pow(2.718281828,v*f)+b.cf;for(c=1;c<d;c+=1)m.setTime(h.getTime()),h.setTime(a.dateMath.addPeriods(m,1,b.pmtFreq)),f=a.dateMath.countPeriods(m,h,b.pmtFreq).days,e=e*Math.pow(2.718281828,v*f)+b.cf;b.pmtMthd===a.PMT_METHOD.ADVANCE&&(m.setTime(h.getTime()),
h.setTime(a.dateMath.addPeriods(m,1,b.pmtFreq)),f=a.dateMath.countPeriods(m,h,b.pmtFreq).days,e*=Math.pow(2.718281828,v*f))}else if(b.cmpFreq===a.CMP_FREQUENCY.DAILY&&b.pmtFreq!==a.PMT_FREQUENCY.DAILY){e=b.pv*Math.pow(1+v,f)+b.cf;for(c=1;c<d;c+=1)m.setTime(h.getTime()),h.setTime(a.dateMath.addPeriods(m,1,b.pmtFreq)),f=a.dateMath.countPeriods(m,h,b.pmtFreq).days,e=e*Math.pow(1+v,f)+b.cf;b.pmtMthd===a.PMT_METHOD.ADVANCE&&(m.setTime(h.getTime()),h.setTime(a.dateMath.addPeriods(m,1,b.pmtFreq)),f=a.dateMath.countPeriods(m,
h,b.pmtFreq).days,e*=Math.pow(1+v,f))}else b.cmpFreq===a.CMP_FREQUENCY.DAILY?(c=Math.pow(1+v,b.n),e=b.pv*c+b.cf*(c-1)*(1+v*b.pmtMthd)/v):e=null;return e}function l(b){var c;if(b.cmpFreq<a.CMP_FREQUENCY.WEEKLY||b.cmpFreq>a.CMP_FREQUENCY.ANNUALLY||null===b.n||0===b.oDate.valueOf()||0===b.fDate.valueOf()||b.oDate.valueOf()>b.fDate.valueOf()||null===b.pmtMthd||null===b.pmtFreq||null===b.cmpFreq)return null;I={days:0,periods:1,oddDays:0};J=K=0;G(b);C=b.n;d(b);if(0!==q||0!==v)b.pmtMthd===a.PMT_METHOD.ARREARS&&
b.n===C?(c=b.cf*((1-Math.pow(1+q,-C))/q)+-b.fv/Math.pow(1+q,C),c/=Math.pow(1+P,K),c/=1+v*J):b.pmtMthd===a.PMT_METHOD.ARREARS?(c=b.cf*((1-Math.pow(1+q,-C))/q)+-b.fv/Math.pow(1+q,C),c=(c+b.cf)/Math.pow(1+P,K),c/=1+v*J):c=b.cf*((1-Math.pow(1+q,-b.n))/q)*(1+q)+-b.fv/Math.pow(1+q,b.n);return-c}function c(b){var c,d,e=0,f=0,m=new Date(0),h=new Date(0);if(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY||null===b.n||0===b.oDate.valueOf()||0===b.fDate.valueOf()||b.oDate.valueOf()>b.fDate.valueOf()||
null===b.pmtMthd||null===b.pmtFreq||null===b.cmpFreq)return null;G(b);0===b.lDate.valueOf()&&b.pmtMthd===a.PMT_METHOD.ARREARS?h.setTime(a.dateMath.addPeriods(b.fDate,b.n-1,b.pmtFreq)):0===b.lDate.valueOf()?h.setTime(a.dateMath.addPeriods(b.fDate,b.n,b.pmtFreq)):h.setTime(b.lDate.getTime());if(0===b.cf&&b.cmpFreq!==a.CMP_FREQUENCY.EXACT||null===b.cf)return e=a.dateMath.countPeriods(b.oDate,h,b.pmtFreq).days,d=b.cmpFreq===a.CMP_FREQUENCY.EXACT?b.fv/(1+v*e):b.cmpFreq===a.CMP_FREQUENCY.DAILY?b.fv/Math.pow(1+
v,e):b.fv/Math.pow(2.718281828,v*e);c=b.n;b.oDate.valueOf()!==b.fDate.valueOf()&&(--c,f=a.dateMath.countPeriods(b.oDate,b.fDate,b.pmtFreq).days);m.setTime(a.dateMath.addPeriods(h,-1,b.pmtFreq));e=a.dateMath.countPeriods(m,h,b.pmtFreq).days;if(b.cmpFreq===a.CMP_FREQUENCY.EXACT){d=b.pmtMthd===a.PMT_METHOD.ARREARS?(-b.fv+b.cf)/(1+v*e):-b.fv/(1+v*e);for(--c;0<c;--c)h.setTime(m.getTime()),m.setTime(a.dateMath.addPeriods(h,-1,b.pmtFreq)),e=a.dateMath.countPeriods(m,h,b.pmtFreq).days,d=(d+b.cf)/(1+v*e);
d=0!==f?(d+b.cf)/(1+v*f):d+b.cf}else if(b.cmpFreq===a.CMP_FREQUENCY.CONTINUOUS){d=b.pmtMthd===a.PMT_METHOD.ARREARS?(-b.fv+b.cf)/Math.pow(2.718281828,v*e):-b.fv/Math.pow(2.718281828,v*e);for(--c;0<c;--c)h.setTime(m.getTime()),m.setTime(a.dateMath.addPeriods(h,-1,b.pmtFreq)),e=a.dateMath.countPeriods(m,h,b.pmtFreq).days,d=(d+b.cf)/Math.pow(2.718281828,v*e);d=0!==f?(d+b.cf)/Math.pow(2.718281828,v*f):d+b.cf}else if(b.cmpFreq===a.CMP_FREQUENCY.DAILY&&b.pmtFreq!==a.PMT_FREQUENCY.DAILY){d=b.pmtMthd===a.PMT_METHOD.ARREARS?
(-b.fv+b.cf)/Math.pow(1+v,e):-b.fv/Math.pow(1+v,e);for(--c;0<c;--c)h.setTime(m.getTime()),m.setTime(a.dateMath.addPeriods(h,-1,b.pmtFreq)),e=a.dateMath.countPeriods(m,h,b.pmtFreq).days,d=(d+b.cf)/Math.pow(1+v,e);d=0!==f?(d+b.cf)/Math.pow(1+v,f):d+b.cf}else b.cmpFreq===a.CMP_FREQUENCY.DAILY&&(d=b.pmtMthd===a.PMT_METHOD.ARREARS?b.cf*((1-Math.pow(1+v,-b.n))/v)+-b.fv/Math.pow(1+v,b.n):b.cf*((1-Math.pow(1+v,-b.n))/v)*(1+v)+-b.fv/Math.pow(1+v,b.n));return-d}function D(b){if((null===b.n||isNaN(b.n))&&(0===
b.oDate.valueOf()||0!==b.fDate.valueOf()||0===b.lDate.valueOf()||b.pmtMthd===a.PMT_METHOD.ADVANCE))return null;if((null===b.pmtFreq||isNaN(b.pmtFreq))&&b.cmpFreq>=a.CMP_FREQUENCY.DAILY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY)b.pmtFreq=b.cmpFreq;else if((null===b.pmtFreq||isNaN(b.pmtFreq))&&null!==b.cmpFreq)b.pmtFreq=a.PMT_FREQUENCY.DAILY;else if(null===b.pmtFreq||isNaN(b.pmtFreq))return!1;if(null===b.cmpFreq||isNaN(b.cmpFreq))b.cmpFreq=b.pmtFreq;0!==b.fDate.valueOf()&&0===b.lDate.valueOf()?a.dateMath.setRefDate(b.fDate):
0!==b.lDate.valueOf()&&a.dateMath.setRefDate(b.lDate);if(null===b.n&&(b.pmtMthd!==a.PMT_METHOD.ADVANCE&&0===b.fDate.valueOf()&&null!==b.pmtFreq&&null===b.n&&0!==b.oDate.valueOf()&&0!==b.lDate.valueOf()&&(b.n=a.dateMath.countPeriods(b.oDate,b.lDate,b.pmtFreq).periods,b.fDate.setTime(a.dateMath.addPeriods(b.lDate,-b.n,b.pmtFreq)),b.pmtMthd===a.PMT_METHOD.ARREARS?b.fDate.setTime(a.dateMath.addPeriods(b.fDate,1,b.pmtFreq)):null===b.pmtMthd&&b.oDate.valueOf()!==b.fDate.valueOf()?(b.fDate.setTime(a.dateMath.addPeriods(b.fDate,
1,b.pmtFreq)),b.pmtMthd=a.PMT_METHOD.ARREARS):null===b.pmtMthd&&b.oDate.valueOf()===b.fDate.valueOf()&&(b.pmtMthd=a.PMT_METHOD.ADVANCE)),null===b.n))return!1;0===b.oDate.valueOf()&&0===b.fDate.valueOf()?b.oDate.setTime(a.dateMath.getFirstNextMonth(new Date)):0===b.oDate.valueOf()&&(b.pmtMthd===a.PMT_METHOD.ARREARS?b.oDate.setTime(a.dateMath.addPeriods(b.fDate,-1,b.pmtFreq)):b.oDate.setTime(b.fDate.getTime()));0===b.fDate.valueOf()&&b.pmtMthd===a.PMT_METHOD.ARREARS?(b.fDate.setTime(a.dateMath.addPeriods(b.oDate,
1,b.pmtFreq)),a.dateMath.setRefDate(b.fDate)):0===b.fDate.valueOf()&&(b.fDate.setTime(b.oDate.getTime()),a.dateMath.setRefDate(b.fDate));if(b.oDate.valueOf()>b.fDate.valueOf())return!1;if((null===b.pmtMthd||isNaN(b.pmtMthd))&&b.oDate.valueOf()===b.fDate.valueOf())b.pmtMthd=a.PMT_METHOD.ADVANCE;else if(null===b.pmtMthd||isNaN(b.pmtMthd))b.pmtMthd=a.PMT_METHOD.ARREARS;if(b.oDate.valueOf()===b.fDate.valueOf()&&b.pmtMthd!==a.PMT_METHOD.ADVANCE||b.oDate.valueOf()!==b.fDate.valueOf()&&b.pmtMthd!==a.PMT_METHOD.ARREARS)return!1;
if(null===b.daysPerYear||isNaN(b.daysPerYear))b.daysPerYear=a.DAYS_PER_YEAR[a.DIY];return!0}function Q(b,c){var d,e=0,h=0,m=0,g=0,k=0,D=0,l=0,u=0,n=0,A=0,x=0,B=0,r=0,z=0,w=[];if(void 0===c||null===c)c=a.schedule.schedule1;d=0;do if(d+=1,e=a.roundMoney(b[d-1][5]+e),h=a.roundMoney(b[d-1][6]+h),m=a.roundMoney(b[d-1][7]+m),g=a.roundMoney(b[d-1][8]+g),k=a.roundMoney(b[d-1][9]+k),D=a.roundMoney(b[d-1][10]+D),u=a.roundMoney(b[d-1][5]+u),n=a.roundMoney(b[d-1][6]+n),A=a.roundMoney(b[d-1][7]+A),x=a.roundMoney(b[d-
1][8]+x),B=a.roundMoney(b[d-1][9]+B),r=a.roundMoney(b[d-1][10]+r),"XPMT"===b[d-1][3].toUpperCase()&&(l=a.roundMoney(b[d-1][9]+l),z=a.roundMoney(b[d-1][9]+z)),b[d-1][13]!==b[d][13]&&(12>=b[d-1][12]||12<b[d][12])||b[d-1][13]===b[d][13]&&12>=b[d-1][12]&&12<b[d][12])w=[],w[0]=b[d-1][0],w[0]=w[0].substr(0,w[0].length-3)+"-99",w[1]=c,w[2]=a.ROW_TYPES.ANNUAL_TOTALS,w[3]=b[d-1][13]+" YTD:",w[4]=null,w[5]=e,w[6]=h,w[7]=m,w[8]=g,w[10]=D,w[9]=k,w[11]=null,w[12]=12,w[13]=b[d-1][13],w[14]=l,l=D=k=g=m=h=e=0,b.splice(d,
0,w),d+=1,w=[],w[0]=b[d-1][0],w[0]=w[0].substr(0,w[0].length-3)+"-99",w[1]=c,w[2]=a.ROW_TYPES.RUNNING_TOTALS,w[3]="Running Totals:",w[4]=null,w[5]=u,w[6]=n,w[7]=A,w[8]=x,w[10]=r,w[9]=B,w[11]=null,w[12]=12,w[13]=b[d-1][13],w[14]=z,b.splice(d,0,w),d+=1;while(d<b.length-1);b[b.length-1][2]!==a.ROW_TYPES.RUNNING_TOTALS&&(e=a.roundMoney(b[b.length-1][5]+e),h=a.roundMoney(b[b.length-1][6]+h),m=a.roundMoney(b[b.length-1][7]+m),g=a.roundMoney(b[b.length-1][8]+g),k=a.roundMoney(b[b.length-1][9]+k),D=a.roundMoney(b[b.length-
1][10]+D),u=a.roundMoney(b[b.length-1][5]+u),n=a.roundMoney(b[b.length-1][6]+n),A=a.roundMoney(b[b.length-1][7]+A),x=a.roundMoney(b[b.length-1][8]+x),B=a.roundMoney(b[b.length-1][9]+B),r=a.roundMoney(b[b.length-1][10]+r),"XPMT"===b[b.length-1][3].toUpperCase()&&(l=a.roundMoney(b[b.length-1][9]+l),z=a.roundMoney(b[b.length-1][9]+z)),w=[],w[0]=b[d][0],w[0]=w[0].substr(0,w[0].length-3)+"-99",w[1]=c,w[2]=a.ROW_TYPES.ANNUAL_TOTALS,w[3]=b[b.length-1][13]+" YTD:",w[4]=null,w[5]=e,w[6]=h,w[7]=m,w[8]=g,w[9]=
k,w[10]=D,w[11]=null,w[12]=12,w[13]=b[b.length-1][13],w[14]=l,b.push(w),w=[],w[0]=b[d][0],w[0]=w[0].substr(0,w[0].length-3)+"-99",w[1]=c,w[2]=a.ROW_TYPES.RUNNING_TOTALS,w[3]="Running Totals:",w[4]=null,w[5]=u,w[6]=n,w[7]=A,w[8]=x,w[9]=B,w[10]=r,w[11]=null,w[12]=12,w[13]=b[b.length-1][13],w[14]=z,b.push(w));f.summary.totalInterest[c]=x;f.summary.totalPmts[c]=u;return null}function B(b,c){var h,p,g,m,k,l,B,v,q,n,A=1,x=n=0,E=0;p=[];var r=new Date(0),z=new Date(0),w=0,O=0,F=0,t=[];if(void 0===c||null===
c)c=a.schedule.schedule1;if(D(b)){f.summary.nominalRate[c]=b.nominalRate;f.summary.pmtFreq=b.pmtFreq;f.summary.cmpFreq=b.cmpFreq;f.summary.amortMthd=b.amortMthd;G(b);q=d(b);g=0;p=b.pv;0<p?(m=p,k=null):0>p?(k=p,m=null):k=m=null;a.dateMath.setRefDate(b.fDate);r.setTime(b.oDate.getTime());l=a.dateMath.dateToDateStr(r,a.dateConventions);f.summary.firstDebitDateStr=l;B=a.dateMath.dateToDateStr(r,a.sortConventions);t.push([B,c,a.ROW_TYPES.DETAIL,"0:"+A,l,g,m,k,n,x,null,p,r.getMonth()+1,r.getFullYear(),
r,r.valueOf()]);h=1;v=h+":"+A;g=-b.cf;z.setTime(b.fDate.getTime());l=a.dateMath.dateToDateStr(z,a.dateConventions);f.summary.firstCreditDateStr=l;B=a.dateMath.dateToDateStr(z,a.sortConventions);0<b.cf?(m=b.cf,k=null):0>b.cf?(k=b.cf,m=null):k=m=null;switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.CANADIAN:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,J,K,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));
n=a.roundMoney(n);x=a.roundMoney(g-n);p=a.roundMoney(p+n+b.cf);break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:E=a.roundMoney(b.pv/b.n);b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,J,K,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=E;p=a.roundMoney(p-x);g=n+x;break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,J,K,q)):(n=
a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(0);p=a.roundMoney(p-x);g=n;break;case f.AMORT_MTHD_EXT.NO_INTEREST:E=a.roundMoney(b.pv/b.n);n=a.roundMoney(0);x=E;p=a.roundMoney(p-x);g=x;break;case f.AMORT_MTHD_EXT.RULE_OF_78S:n=a.dateMath.countPeriods(b.oDate,b.fDate,b.pmtFreq).oddDays;if(0!==n||1<q)return alert('Presently, the initial period must be a regular length\nperiod when the "Amortization Method" is set\nto "Rule-of-78\'s".\n\nThis means the time between the "Loan Date" and the\n"1st Payment Date"must be a period of time equal to\nthe "Payment Frequency".'),
!1;O=a.roundMoney(g*b.n-b.pv);w=b.n*(b.n+1)/2;if(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY)n=h*(b.n-(h-1)+b.n)/2/w*O-F;else return alert('Presently "Continuous", "Daily" and "Exact" compounding\ncannot be used with the "Rule-of-78s" amortization method.'),!1;F+=n;n=a.roundMoney(n);x=a.roundMoney(g-n);p=a.roundMoney(p-x)}t.push([B,c,a.ROW_TYPES.DETAIL,v,l,g,m,k,n,x,null,p,z.getMonth()+1,z.getFullYear(),z,z.valueOf()]);h=2;q=1;do{r.setTime(z.getTime());z.setTime(a.dateMath.addPeriods(z,
1,b.pmtFreq));l=a.dateMath.dateToDateStr(z,a.dateConventions);B=a.dateMath.dateToDateStr(z,a.sortConventions);1===h%a.PPY[b.pmtFreq]&&(A+=1);v=h+":"+A;switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.CANADIAN:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,0,0,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(g-n);p=a.roundMoney(p+n+b.cf);break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:b.cmpFreq>=
a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,0,0,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=E;p=a.roundMoney(p-x);g=n+x;break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,0,0,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(0);p=a.roundMoney(p-x);g=n;break;
case f.AMORT_MTHD_EXT.NO_INTEREST:n=a.roundMoney(0);x=E;p=a.roundMoney(p-x);g=x;break;case f.AMORT_MTHD_EXT.RULE_OF_78S:if(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY)n=h*(b.n-(h-1)+b.n)/2/w*O-F;else return alert('Presently "Continuous", "Daily" and "Exact" compounding\ncannot be used with the "Rule-of-78s" amortization method.'),!1;F+=n;n=a.roundMoney(n);x=a.roundMoney(g-n);p=a.roundMoney(p-x)}t.push([B,c,a.ROW_TYPES.DETAIL,v,l,g,m,k,n,x,null,p,z.getMonth()+1,z.getFullYear(),
z,z.valueOf()]);h+=1}while(h<=b.n&&0<p);p=t[t.length-1];f.summary.unadjustedBalance=p[11];f.summary.cf[c]=p[5];switch(f.roundingMethod){case a.ROUNDING_METHOD.RMLASTPMT:p[5]+=f.summary.unadjustedBalance,p[11]-=f.summary.unadjustedBalance,p[9]+=f.summary.unadjustedBalance}f.summary.totalNDebits[c]=h-1;f.summary.totalNCredits[c]=1;f.summary.lastDebitDateStr[c]=t[0][4];f.summary.lastCreditDateStr[c]=p[4];Q(t,c);return c===a.schedule.schedule2?T=t:R=t}return null}function E(b,c,h,p){var g,m,k,l,B,v,q,
n,A,x,E=1,r=0,z=0,w=0;m=[];var O=new Date(0),F=new Date(0),t=0,H=0,C=0,N=[];if(void 0===p||null===p)p=a.schedule.schedule1;if(D(b)){f.summary.nominalRate[p]=b.nominalRate;f.summary.pmtFreq=b.pmtFreq;f.summary.cmpFreq=b.cmpFreq;f.summary.amortMthd=b.amortMthd;f.summary.xPmtTotal=0;G(b);A=d(b);k=0;m=b.pv;0<m?(l=m,B=null):0>m?(B=m,l=null):B=l=null;a.dateMath.setRefDate(b.fDate);O.setTime(b.oDate.getTime());v=a.dateMath.dateToDateStr(O,a.dateConventions);f.summary.firstDebitDateStr=v;q=a.dateMath.dateToDateStr(O,
a.sortConventions);g=0;N.push([q,p,a.ROW_TYPES.DETAIL,g+":"+E,v,k,l,B,r,z,null,m,O.getMonth()+1,O.getFullYear(),O,O.valueOf()]);g===h&&0<m&&(m>c?m=a.roundMoney(m-c):(c=m,m=0),f.summary.xPmtTotal+=c,N.push([q,p,a.ROW_TYPES.DETAIL,"XPmt","",c,l,B,0,c,null,m,O.getMonth()+1,O.getFullYear(),O,O.valueOf()]));g=1;n=g+":"+E;k=-b.cf;F.setTime(b.fDate.getTime());v=a.dateMath.dateToDateStr(F,a.dateConventions);q=a.dateMath.dateToDateStr(F,a.sortConventions);0<b.cf?(l=b.cf,B=null):0>b.cf?(B=b.cf,l=null):B=l=
null;switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.CANADIAN:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?r=a.roundMoney(u(m,J,K,A)):(x=a.dateMath.countPeriods(O,F,b.pmtFreq).days,r=a.roundMoney(e(m,x,b.cmpFreq)));r=a.roundMoney(r);z=a.roundMoney(k-r);m=a.roundMoney(m+r+b.cf);break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:w=a.roundMoney(b.pv/b.n);b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?r=a.roundMoney(u(m,J,K,A)):(x=a.dateMath.countPeriods(O,
F,b.pmtFreq).days,r=a.roundMoney(e(m,x,b.cmpFreq)));r=a.roundMoney(r);z=w;m=a.roundMoney(m-z);k=r+z;break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?r=a.roundMoney(u(m,J,K,A)):(x=a.dateMath.countPeriods(O,F,b.pmtFreq).days,r=a.roundMoney(e(m,x,b.cmpFreq)));r=a.roundMoney(r);z=a.roundMoney(0);m=a.roundMoney(m-z);k=r;break;case f.AMORT_MTHD_EXT.NO_INTEREST:w=a.roundMoney(b.pv/b.n);r=a.roundMoney(0);z=w;m=a.roundMoney(m-z);k=z;break;case f.AMORT_MTHD_EXT.RULE_OF_78S:if(0!==
x||1<A)return alert('Presently, the initial period must be a regular length\nperiod when the "Amortization Method" is set\nto "Rule-of-78\'s".\n\nThis means the time between the "Loan Date" and the\n"1st Payment Date"must be a period of time equal to\nthe "Payment Frequency".'),!1;H=a.roundMoney(k*b.n-b.pv);t=b.n*(b.n+1)/2;if(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY)r=g*(b.n-(g-1)+b.n)/2/t*H-C;else return alert('Presently "Continuous", "Daily" and "Exact" compounding\ncannot be used with the "Rule-of-78s" amortization method.'),
!1;C+=r;r=a.roundMoney(r);z=a.roundMoney(k-r);m=a.roundMoney(m-z)}N.push([q,p,a.ROW_TYPES.DETAIL,n,v,k,l,B,r,z,null,m,F.getMonth()+1,F.getFullYear(),F,F.valueOf()]);g>=h&&0<m&&(m>c?m=a.roundMoney(m-c):(c=m,m=0),f.summary.xPmtTotal+=c,N.push([q,p,a.ROW_TYPES.DETAIL,"XPmt","",c,l,B,0,c,null,m,F.getMonth()+1,F.getFullYear(),F,F.valueOf()]));g=2;A=1;do{O.setTime(F.getTime());F.setTime(a.dateMath.addPeriods(F,1,b.pmtFreq));v=a.dateMath.dateToDateStr(F,a.dateConventions);q=a.dateMath.dateToDateStr(F,a.sortConventions);
1===g%a.PPY[b.pmtFreq]&&(E+=1);n=g+":"+E;switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.CANADIAN:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?r=a.roundMoney(u(m,0,0,A)):(x=a.dateMath.countPeriods(O,F,b.pmtFreq).days,r=a.roundMoney(e(m,x,b.cmpFreq)));r=a.roundMoney(r);z=a.roundMoney(k-r);m=a.roundMoney(m+r+b.cf);break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?r=a.roundMoney(u(m,0,0,
A)):(x=a.dateMath.countPeriods(O,F,b.pmtFreq).days,r=a.roundMoney(e(m,x,b.cmpFreq)));r=a.roundMoney(r);z=w;m=a.roundMoney(m-z);k=r+z;break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?r=a.roundMoney(u(m,0,0,A)):(x=a.dateMath.countPeriods(O,F,b.pmtFreq).days,r=a.roundMoney(e(m,x,b.cmpFreq)));r=a.roundMoney(r);z=a.roundMoney(0);m=a.roundMoney(m-z);k=r;break;case f.AMORT_MTHD_EXT.NO_INTEREST:r=a.roundMoney(0);z=w;m=a.roundMoney(m-z);k=z;break;
case f.AMORT_MTHD_EXT.RULE_OF_78S:if(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY)r=g*(b.n-(g-1)+b.n)/2/t*H-C;else return alert('Presently "Continuous", "Daily" and "Exact" compounding\ncannot be used with the "Rule-of-78s" amortization method.'),!1;C+=r;r=a.roundMoney(r);z=a.roundMoney(k-r);m=a.roundMoney(m-z)}N.push([q,p,a.ROW_TYPES.DETAIL,n,v,k,l,B,r,z,null,m,F.getMonth()+1,F.getFullYear(),F,F.valueOf()]);g>=h&&0<m&&(m>c?m=a.roundMoney(m-c):(c=m,m=0),f.summary.xPmtTotal+=
c,N.push([q,p,a.ROW_TYPES.DETAIL,"XPmt","",c,l,B,0,c,null,m,F.getMonth()+1,F.getFullYear(),F,F.valueOf()]));g+=1}while(g<=b.n&&0<m);m=N[N.length-1];f.summary.unadjustedBalance=m[11];f.summary.cf[p]=m[5];switch(f.roundingMethod){case a.ROUNDING_METHOD.RMLASTPMT:m[5]+=f.summary.unadjustedBalance,m[11]-=f.summary.unadjustedBalance,m[9]+=f.summary.unadjustedBalance}f.summary.totalNDebits[p]=g-1;f.summary.totalNCredits[p]=1;f.summary.lastDebitDateStr[p]=N[0][4];f.summary.lastCreditDateStr[p]=m[4];Q(N,
p);return p===a.schedule.schedule2?T=N:R=N}return null}function h(b,c){var h,p,g,m,k,l,B,v,q,n,A=1,x=n=0,E=0;p=[];var r=new Date(0),z=new Date(0),w=0,Q=0,F=0,t=[],C=0,H,N,L,I;I=a.roundMoney(b.ins/a.PPY[b.pmtFreq]);L=a.roundMoney(b.propTax/a.PPY[b.pmtFreq]);H=a.roundMoney(b.pv*b.pmi/a.PPY[b.pmtFreq]);N=a.roundMoney(.8*b.price);if(void 0===c||null===c)c=a.schedule.schedule1;if(D(b)){f.summary.nominalRate[c]=b.nominalRate;f.summary.pmtFreq=b.pmtFreq;f.summary.cmpFreq=b.cmpFreq;f.summary.amortMthd=b.amortMthd;
f.summary.propTaxes=L;f.summary.ins=I;G(b);q=d(b);g=0;p=b.pv;0<p?(m=p,k=null):0>p?(k=p,m=null):k=m=null;a.dateMath.setRefDate(b.fDate);r.setTime(b.oDate.getTime());l=a.dateMath.dateToDateStr(r,a.dateConventions);f.summary.firstDebitDateStr=l;B=a.dateMath.dateToDateStr(r,a.sortConventions);t.push([B,c,a.ROW_TYPES.DETAIL,"0:"+A,l,g,m,k,n,x,null,p,r.getMonth()+1,r.getFullYear(),r,r.valueOf(),0,0,0,C]);h=1;v=h+":"+A;g=-b.cf;z.setTime(b.fDate.getTime());l=a.dateMath.dateToDateStr(z,a.dateConventions);
f.summary.firstCreditDateStr=l;B=a.dateMath.dateToDateStr(z,a.sortConventions);0<b.cf?(m=b.cf,k=null):0>b.cf?(k=b.cf,m=null):k=m=null;switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.CANADIAN:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,J,K,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(g-n);p=a.roundMoney(p+n+b.cf);break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:E=
a.roundMoney(b.pv/b.n);b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,J,K,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=E;p=a.roundMoney(p-x);g=n+x;break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,J,K,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(0);
p=a.roundMoney(p-x);g=n;break;case f.AMORT_MTHD_EXT.NO_INTEREST:E=a.roundMoney(b.pv/b.n);n=a.roundMoney(0);x=E;p=a.roundMoney(p-x);g=x;break;case f.AMORT_MTHD_EXT.RULE_OF_78S:n=a.dateMath.countPeriods(b.oDate,b.fDate,b.pmtFreq).oddDays;if(0!==n||1<q)return alert('Presently, the initial period must be a regular length\nperiod when the "Amortization Method" is set\nto "Rule-of-78\'s".\n\nThis means the time between the "Loan Date" and the\n"1st Payment Date"must be a period of time equal to\nthe "Payment Frequency".'),
!1;Q=a.roundMoney(g*b.n-b.pv);w=b.n*(b.n+1)/2;if(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY)n=h*(b.n-(h-1)+b.n)/2/w*Q-F;else return alert('Presently "Continuous", "Daily" and "Exact" compounding\ncannot be used with the "Rule-of-78s" amortization method.'),!1;F+=n;n=a.roundMoney(n);x=a.roundMoney(g-n);p=a.roundMoney(p-x)}p<=N&&(H=0);C=a.roundMoney(g+L+I+H);t.push([B,c,a.ROW_TYPES.DETAIL,v,l,g,m,k,n,x,null,p,z.getMonth()+1,z.getFullYear(),z,z.valueOf(),L,I,H,C]);h=2;q=1;
do{r.setTime(z.getTime());z.setTime(a.dateMath.addPeriods(z,1,b.pmtFreq));l=a.dateMath.dateToDateStr(z,a.dateConventions);B=a.dateMath.dateToDateStr(z,a.sortConventions);1===h%a.PPY[b.pmtFreq]&&(A+=1);v=h+":"+A;switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.CANADIAN:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,0,0,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(g-
n);p=a.roundMoney(p+n+b.cf);break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,0,0,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,n,b.cmpFreq)));n=a.roundMoney(n);x=E;p=a.roundMoney(p-x);g=n+x;break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(p,0,0,q)):(n=a.dateMath.countPeriods(r,z,b.pmtFreq).days,n=a.roundMoney(e(p,
n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(0);p=a.roundMoney(p-x);g=n;break;case f.AMORT_MTHD_EXT.NO_INTEREST:n=a.roundMoney(0);x=E;p=a.roundMoney(p-x);g=x;break;case f.AMORT_MTHD_EXT.RULE_OF_78S:if(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY)n=h*(b.n-(h-1)+b.n)/2/w*Q-F;else return alert('Presently "Continuous", "Daily" and "Exact" compounding\ncannot be used with the "Rule-of-78s" amortization method.'),!1;F+=n;n=a.roundMoney(n);x=a.roundMoney(g-n);p=a.roundMoney(p-
x)}C=a.roundMoney(g+L+I+H);t.push([B,c,a.ROW_TYPES.DETAIL,v,l,g,m,k,n,x,null,p,z.getMonth()+1,z.getFullYear(),z,z.valueOf(),L,I,H,C]);p<=N&&(H=0);h+=1}while(h<=b.n&&0<p);p=t[t.length-1];f.summary.unadjustedBalance=p[11];f.summary.cf[c]=p[5];switch(f.roundingMethod){case a.ROUNDING_METHOD.RMLASTPMT:p[5]+=f.summary.unadjustedBalance,p[11]-=f.summary.unadjustedBalance,p[9]+=f.summary.unadjustedBalance,p[19]+=f.summary.unadjustedBalance}f.summary.totalNDebits[c]=h-1;f.summary.totalNCredits[c]=1;f.summary.lastDebitDateStr[c]=
t[0][4];f.summary.lastCreditDateStr[c]=p[4];h=c;var P=C=I=L=N=H=F=Q=w=z=r=x=n=q=v=B=l=k=m=g=p=E=0,y=[];if(void 0===h||null===h)h=a.schedule.schedule1;A=0;do if(A+=1,E=a.roundMoney(t[A-1][5]+E),p=a.roundMoney(t[A-1][6]+p),g=a.roundMoney(t[A-1][7]+g),m=a.roundMoney(t[A-1][8]+m),k=a.roundMoney(t[A-1][9]+k),l=a.roundMoney(t[A-1][10]+l),v=a.roundMoney(t[A-1][16]+v),q=a.roundMoney(t[A-1][17]+q),n=a.roundMoney(t[A-1][18]+n),x=a.roundMoney(t[A-1][19]+x),r=a.roundMoney(t[A-1][5]+r),z=a.roundMoney(t[A-1][6]+
z),w=a.roundMoney(t[A-1][7]+w),Q=a.roundMoney(t[A-1][8]+Q),F=a.roundMoney(t[A-1][9]+F),H=a.roundMoney(t[A-1][10]+H),L=a.roundMoney(t[A-1][16]+L),I=a.roundMoney(t[A-1][17]+I),C=a.roundMoney(t[A-1][18]+C),P=a.roundMoney(t[A-1][19]+P),"XPMT"===t[A-1][3].toUpperCase()&&(B=a.roundMoney(t[A-1][9]+B),N=a.roundMoney(t[A-1][9]+N)),t[A-1][13]!==t[A][13]&&(12>=t[A-1][12]||12<t[A][12])||t[A-1][13]===t[A][13]&&12>=t[A-1][12]&&12<t[A][12])y=[],y[0]=t[A-1][0],y[0]=y[0].substr(0,y[0].length-3)+"-99",y[1]=h,y[2]=
a.ROW_TYPES.ANNUAL_TOTALS,y[3]=t[A-1][13]+" YTD:",y[4]=null,y[5]=E,y[6]=p,y[7]=g,y[8]=m,y[10]=l,y[9]=k,y[11]=null,y[12]=12,y[13]=t[A-1][13],y[14]=B,y[14]=null,y[15]=null,y[16]=v,y[17]=q,y[18]=n,y[19]=x,x=n=q=v=B=l=k=m=g=p=E=0,t.splice(A,0,y),A+=1,y=[],y[0]=t[A-1][0],y[0]=y[0].substr(0,y[0].length-3)+"-99",y[1]=h,y[2]=a.ROW_TYPES.RUNNING_TOTALS,y[3]="Running Totals:",y[4]=null,y[5]=r,y[6]=z,y[7]=w,y[8]=Q,y[10]=H,y[9]=F,y[11]=null,y[12]=12,y[13]=t[A-1][13],y[14]=N,y[14]=null,y[15]=null,y[16]=L,y[17]=
I,y[18]=C,y[19]=P,t.splice(A,0,y),A+=1;while(A<t.length-1);t[t.length-1][2]!==a.ROW_TYPES.RUNNING_TOTALS&&(E=a.roundMoney(t[t.length-1][5]+E),p=a.roundMoney(t[t.length-1][6]+p),g=a.roundMoney(t[t.length-1][7]+g),m=a.roundMoney(t[t.length-1][8]+m),k=a.roundMoney(t[t.length-1][9]+k),l=a.roundMoney(t[t.length-1][10]+l),v=a.roundMoney(t[t.length-1][16]+v),q=a.roundMoney(t[t.length-1][17]+q),n=a.roundMoney(t[t.length-1][18]+n),x=a.roundMoney(t[t.length-1][19]+x),r=a.roundMoney(t[t.length-1][5]+r),z=a.roundMoney(t[t.length-
1][6]+z),w=a.roundMoney(t[t.length-1][7]+w),Q=a.roundMoney(t[t.length-1][8]+Q),F=a.roundMoney(t[t.length-1][9]+F),H=a.roundMoney(t[t.length-1][10]+H),L=a.roundMoney(t[t.length-1][16]+L),I=a.roundMoney(t[t.length-1][17]+I),C=a.roundMoney(t[t.length-1][18]+C),P=a.roundMoney(t[t.length-1][19]+P),"XPMT"===t[t.length-1][3].toUpperCase()&&(B=a.roundMoney(t[t.length-1][9]+B),N=a.roundMoney(t[t.length-1][9]+N)),y=[],y[0]=t[A][0],y[0]=y[0].substr(0,y[0].length-3)+"-99",y[1]=h,y[2]=a.ROW_TYPES.ANNUAL_TOTALS,
y[3]=t[t.length-1][13]+" YTD:",y[4]=null,y[5]=E,y[6]=p,y[7]=g,y[8]=m,y[9]=k,y[10]=l,y[11]=null,y[12]=12,y[13]=t[t.length-1][13],y[14]=B,y[16]=v,y[17]=q,y[18]=n,y[19]=x,t.push(y),y=[],y[0]=t[A][0],y[0]=y[0].substr(0,y[0].length-3)+"-99",y[1]=h,y[2]=a.ROW_TYPES.RUNNING_TOTALS,y[3]="Running Totals:",y[4]=null,y[5]=r,y[6]=z,y[7]=w,y[8]=Q,y[9]=F,y[10]=H,y[11]=null,y[12]=12,y[13]=t[t.length-1][13],y[14]=N,y[16]=L,y[17]=I,y[18]=C,y[19]=P,t.push(y));f.summary.totalInterest[h]=Q;f.summary.totalPmts[h]=r;return c===
a.schedule.schedule2?T=t:R=t}return null}var f=a||{},H=new Date(0),L,v,q,P,I,C,K,J,U=!0,R=[],T=[];f.roundingMethod=a.ROUNDING_METHOD.RMLASTPMT;f.AMORT_MTHD_EXT={NORMAL:0,CANADIAN:1,FIXED_PRINCIPAL:2,INTEREST_ONLY:3,NO_INTEREST:4,RULE_OF_78S:5};f.AMORT_MTHD_STRS_EXT="Normal;Canadian;Fixed Principal;Interest Only;No Interest;Rule-of-78s".split(";");f.schedule={schedule1:1,schedule2:2};f.summary={cf:[],firstDebitDateStr:"",firstCreditDateStr:"",lastDebitDateStr:[],lastCreditDateStr:[],totalNDebits:[],
totalNCredits:[],totalInterest:[],totalPmts:[],nominalRate:[],NYears:0,pointsPct:0,pointsMoney:0,amortMthd:0,pmtFreq:0,cmpFreq:0,DIY:0,unadjustedBalance:0,roundingMethod:f.roundingMethod,cashFlowType:a.CASH_FLOW_TYPE.CF_DEBT,xPmtTotal:0,propTaxes:null,ins:null};f.fin_params=function(a){a=a||{};this.nominalRate=void 0!==a.nominalRate?a.nominalRate:null;this.n=a.n||null;this.cf=a.cf||0;this.pv=a.pv||0;this.fv=a.fv||0;this.pmtFreq=void 0!==a.pmtFreq?a.pmtFreq:null;this.cmpFreq=void 0!==a.cmpFreq?a.cmpFreq:
a.pmtFreq;this.daysPerYear=a.daysPerYear||null;this.pmtMthd=void 0!==a.pmtMthd?a.pmtMthd:null;this.amortMthd=void 0!==a.amortMthd?a.amortMthd:f.AMORT_MTHD_EXT.NORMAL;this.oDate=a.oDate||new Date(0);this.fDate=a.fDate||new Date(0);this.lDate=a.lDate||new Date(0)};f.fin_params.prototype.clone=function(){return new f.fin_params({nominalRate:this.nominalRate,n:this.n,cf:this.cf,pv:this.pv,fv:this.fv,pmtFreq:this.pmtFreq,cmpFreq:this.cmpFreq,daysPerYear:this.daysPerYear,pmtMthd:this.pmtMthd,amortMthd:this.amortMthd,
oDate:new Date(this.oDate.valueOf()),fDate:new Date(this.fDate.valueOf()),lDate:new Date(this.lDate.valueOf())})};f.FV={calc:function(b){if(void 0===b||null===b)return null;b.fv=null;if(D(b))return b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?k(b):g(b)}};f.PV={calc:function(b){if(void 0===b||null===b||null===b.nominalRate||isNaN(b.nominalRate)||(null===b.n||isNaN(b.n))&&(0===b.oDate.valueOf()||0!==b.fDate.valueOf()||0===b.lDate.valueOf()||b.pmtMthd===a.PMT_METHOD.ADVANCE)||
0!==b.fDate.valueOf()&&b.oDate.valueOf()>b.fDate.valueOf()||0===b.fv&&0===b.cf||0!==b.pv)return null;b.pv=null;if(D(b))switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.RULE_OF_78S:case f.AMORT_MTHD_EXT.CANADIAN:return b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?l(b):c(b);case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:return b.pmtMthd===a.PMT_METHOD.ARREARS?(alert('Can\'t solve for loan amount when\namortization method is set to "Fixed Principal"\nand "Payment Method" is set to "Arrears".'),
0):Math.abs(b.cf)*b.n;case f.AMORT_MTHD_EXT.INTEREST_ONLY:return b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY&&alert("This is an approximate amount since interest is based on number\nof days and number of days varies from period to period.\nSee schedule for details."),Math.abs(b.cf)/q;case f.AMORT_MTHD_EXT.NO_INTEREST:return Math.abs(b.cf)*b.n}}};f.CF={calc:function(b){var h,g;if(void 0===b||null===b||null===b.nominalRate||isNaN(b.nominalRate)||0!==b.fDate.valueOf()&&b.oDate.valueOf()>
b.fDate.valueOf()||0===b.pv&&0===b.fv||0!==b.cf)return null;b.cf=null;if(D(b))switch(d(b),b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.RULE_OF_78S:case f.AMORT_MTHD_EXT.CANADIAN:L?(G(b),h=Math.pow(1+q,b.n),h=q*(b.fv-b.pv*h)/((h-1)*(1+q*b.pmtMthd))):(b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?(g=b.clone(),g.pv=0,g.cf=0,h=l(g),g.cf=-1,g.fv=0,g=l(g)):(g=b.clone(),g.pv=0,g.cf=0,h=c(g),g.cf=-1,g.fv=0,g=c(g)),h=(h-b.pv)/g);break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:b.pmtMthd===
a.PMT_METHOD.ARREARS?(G(b),h=-(b.pv/b.n+b.pv*q)):h=-(b.pv/b.n);U&&(alert("Fixed principal will not result in a level payment amount.\nThis is the maximum payment.\nSee schedule for details."),U=!1);break;case f.AMORT_MTHD_EXT.NO_INTEREST:h=-b.pv/b.n;break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:G(b),b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?h=-u(b.pv,0,0,1):(h=a.dateMath.countPeriods(b.oDate,b.fDate,b.pmtFreq).days,h=-e(b.pv,h,b.cmpFreq)),h=a.roundMoney(h)}return h}};f.R=
{calc:function(b){var c=0,d=.1,e,h,m={};if(void 0===b||null===b||0!==b.fDate.valueOf()&&b.oDate.valueOf()>b.fDate.valueOf()||0===b.pv&&(0===b.cf||0===b.fv)||0===b.cf&&(0===b.pv||0===b.fv)||0===b.fv&&(0===b.pv||0===b.cf))return null;if(D(b))switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.RULE_OF_78S:case f.AMORT_MTHD_EXT.CANADIAN:m=b.clone();h=m.fv;m.fv=0;if(m.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&m.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY){do m.nominalRate=d,b=k(m)-h,m.nominalRate+=1E-8,
e=k(m)-h-b,0===e?c=100:0===c&&0>b&&0>e&&1>d?(d+=.1,c=-1):d=m.nominalRate-b/e*1E-8,c+=1;while(1E-8<Math.round(1E8*Math.abs(d-m.nominalRate))/1E8&&100>c)}else{do m.nominalRate=d,b=g(m)-h,m.nominalRate+=1E-8,e=g(m)-h-b,0===e?c=100:0===c&&0>b&&0>e&&1>d?(d+=.1,c=-1):d=m.nominalRate-b/e*1E-8,c+=1;while(1E-8<Math.round(1E8*Math.abs(d-m.nominalRate))/1E8&&100>c)}break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:alert('Can\'t solve for interest rate when\n\namortization method is set to "Fixed Principal".');break;
case f.AMORT_MTHD_EXT.NO_INTEREST:d=0;break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:alert('Can\'t solve for interest rate when\n\namortization method is set to "Interest Only".')}100<c&&(d=null);return d}};f.N={calc:function(b){var c;if(void 0===b||null===b||0!==b.fDate.valueOf()&&b.oDate.valueOf()>b.fDate.valueOf()||0===b.pv&&(0===b.cf||0===b.fv)||0===b.cf&&(0===b.pv||0===b.fv)||0===b.fv&&(0===b.pv||0===b.cf))return null;b.n=0;if(D(b))switch(d(b),G(b),b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.RULE_OF_78S:case f.AMORT_MTHD_EXT.CANADIAN:if(L)c=
b.cf*(1+q*b.pmtMthd),c=Math.log((q*b.fv+c)/(q*b.pv+c))/Math.log(1+q);else return b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?alert("Cannot calculate term when initial period is irregular length.\n\nDates must match frequency."):alert("Cannot calculate term when compounding is based on days."),0;break;case f.AMORT_MTHD_EXT.FIXED_PRINCIPAL:if(b.pmtMthd===a.PMT_METHOD.ARREARS)return alert('Can\'t solve for total periods when\namortization method is set to "Fixed Principal"\nand "Payment Method" is set to "Arrears".'),
0;c=Math.abs(b.pv/b.cf);break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:alert('Can\'t solve for total periods when\n\namortization method is set to "Interest Only".\n\nThe term is infinite.');break;case f.AMORT_MTHD_EXT.NO_INTEREST:c=Math.abs((b.pv-b.fv)/b.cf)}return Math.round(c)}};f.Balloon={calcPV:function(b){var c,d;c=b.clone();--c.n;c.fv=0;d=f.PV.calc(c);c=b.clone();c.cf=0;b.pmtMthd===a.PMT_METHOD.ADVANCE&&--c.n;c=f.PV.calc(c)+d;b.pv=c;return b.pv},calcR:function(b){var c,d,e,h,m,l=.1;if(b.amortMthd!==
f.AMORT_MTHD_EXT.NORMAL&&b.amortMthd!==f.AMORT_MTHD_EXT.RULE_OF_78S&&b.amortMthd!==f.AMORT_MTHD_EXT.CANADIAN)return b.nominalRate=null,b.nominalRate;d=b.clone();if(!D(b))return null;m=0;c=b.clone();--c.n;c.fv=0;d.cf=0;d.n=1;b.pmtMthd===a.PMT_METHOD.ADVANCE&&(--c.n,c.pv+=c.cf,c.pmtMthd=a.PMT_METHOD.ARREARS,c.oDate=new Date(0),c.fDate=new Date(0),D(c),d.pmtMthd=a.PMT_METHOD.ARREARS);if(c.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&c.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY){do c.nominalRate=l,d.pv=0,d.nominalRate=l,
e=f.PV.calc(d),h=k(c)-e,c.nominalRate+=1E-8,e=k(c)-e-h,0===e?m=100:0===m&&0>h&&0>e&&1>l?(l+=.1,m=-1):l=c.nominalRate-h/e*1E-8,m+=1;while(1E-8<Math.round(1E8*Math.abs(l-c.nominalRate))/1E8&&100>m)}else{do c.nominalRate=l,d.pv=0,d.nominalRate=l,e=f.PV.calc(d),h=g(c)-e,c.nominalRate+=1E-8,e=g(c)-e-h,0===e?m=100:0===m&&0>h&&0>e&&1>l?(l+=.1,m=-1):l=c.nominalRate-h/e*1E-8,m+=1;while(1E-8<Math.round(1E8*Math.abs(l-c.nominalRate))/1E8&&100>m)}100<m&&(l=null);b.nominalRate=l;return b.nominalRate},calcN:function(a){a.n=
f.N.calc(a)+1;return a.n},calcCF:function(b){var c,d;c=b.clone();b.pmtMthd===a.PMT_METHOD.ADVANCE&&--c.n;c.pv=0;c.cf=0;d=f.PV.calc(c)-b.pv;c=b.clone();c.cf=-1;--c.n;c.fv=0;c.pv=0;c=f.PV.calc(c);b.cf=0!==c?-d/c:0;return b.cf},calcBalloon:function(b){var c,d;c=b.clone();c.pv=0;--c.n;d=f.PV.calc(c)-b.pv;c=b.clone();c.cf=0;c.fv=-1;b.pmtMthd===a.PMT_METHOD.ADVANCE&&--c.n;c.pv=0;c=f.PV.calc(c);b.fv=0!==c?d/c:0;return b.fv}};f.Rem_Balance={calcPV:function(a){var c,d;if(a.pmtMthd!==f.PMT_METHOD.ADVANCE)return null;
c=a.clone();c.fv=0;d=f.PV.calc(c);c=a.clone();c.cf=0;--c.n;c.pmtMthd=f.PMT_METHOD.ARREARS;a.pv=f.PV.calc(c)+d;return a.pv},calcCF:function(a){var c,d;if(a.pmtMthd!==f.PMT_METHOD.ADVANCE)return null;c=a.clone();--c.n;c.pv=0;c.cf=0;d=f.PV.calc(c)-a.pv;c=a.clone();c.cf=-1;c.fv=0;c.pv=0;c=f.PV.calc(c);a.cf=0!==c?d/c:0;return a.cf},calcFV:function(a){var c;if(a.pmtMthd!==f.PMT_METHOD.ADVANCE)return null;c=a.clone();--c.n;c.pv+=c.cf;c.pmtMthd=f.PMT_METHOD.ARREARS;a.fv=f.FV.calc(c);return a.fv}};f.LOAN_SCHEDULE=
{calc:function(b,c){B(b,c);c===a.schedule.schedule2&&(R=R.concat(T),R.sort());return R}};f.BRIDGE_LOAN_SCHEDULE={calc:function(b,c){var h,g,k,m,l,B,q,v,E,n,A=1,x=n=0;g=[];var C=new Date(0),r=new Date(0),z=[];z=c===a.schedule.schedule2?T=[]:R=[];if(D(b)){f.summary.nominalRate[c]=b.nominalRate;f.summary.pmtFreq=b.pmtFreq;f.summary.cmpFreq=b.cmpFreq;f.summary.amortMthd=b.amortMthd;G(b);E=d(b);k=0;g=b.pv;0<g?(m=g,l=null):0>g?(l=g,m=null):l=m=null;a.dateMath.setRefDate(b.fDate);C.setTime(b.oDate.getTime());
B=a.dateMath.dateToDateStr(C,a.dateConventions);f.summary.firstDebitDateStr=B;q=a.dateMath.dateToDateStr(C,a.sortConventions);z.push([q,c,a.ROW_TYPES.DETAIL,"0:"+A,B,k,m,l,n,x,null,g,C.getMonth()+1,C.getFullYear(),C,C.valueOf()]);v="1:"+A;k=-b.cf;r.setTime(b.fDate.getTime());B=a.dateMath.dateToDateStr(r,a.dateConventions);q=a.dateMath.dateToDateStr(r,a.sortConventions);0<b.cf?(m=b.cf,l=null):0>b.cf?(l=b.cf,m=null):l=m=null;switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.CANADIAN:b.cmpFreq>=
a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(g,J,K,E)):(n=a.dateMath.countPeriods(C,r,b.pmtFreq).days,n=a.roundMoney(e(g,n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(k-n);g=a.roundMoney(g+n+b.cf);break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(g,J,K,E)):(n=a.dateMath.countPeriods(C,r,b.pmtFreq).days,n=a.roundMoney(e(g,n,b.cmpFreq))),n=a.roundMoney(n),x=a.roundMoney(0),g=a.roundMoney(g-
x),k=n}z.push([q,c,a.ROW_TYPES.DETAIL,v,B,k,m,l,n,x,null,g,r.getMonth()+1,r.getFullYear(),r,r.valueOf()]);h=2;E=1;do{C.setTime(r.getTime());r.setTime(a.dateMath.addPeriods(r,1,b.pmtFreq));B=a.dateMath.dateToDateStr(r,a.dateConventions);q=a.dateMath.dateToDateStr(r,a.sortConventions);1===h%a.PPY[b.pmtFreq]&&(A+=1);v=h+":"+A;switch(b.amortMthd){case f.AMORT_MTHD_EXT.NORMAL:case f.AMORT_MTHD_EXT.CANADIAN:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(g,0,0,E)):
(n=a.dateMath.countPeriods(C,r,b.pmtFreq).days,n=a.roundMoney(e(g,n,b.cmpFreq)));n=a.roundMoney(n);x=a.roundMoney(k-n);g=a.roundMoney(g+n+b.cf);break;case f.AMORT_MTHD_EXT.INTEREST_ONLY:b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?n=a.roundMoney(u(g,0,0,E)):(n=a.dateMath.countPeriods(C,r,b.pmtFreq).days,n=a.roundMoney(e(g,n,b.cmpFreq))),n=a.roundMoney(n),x=a.roundMoney(0),g=a.roundMoney(g-x),k=n}z.push([q,c,a.ROW_TYPES.DETAIL,v,B,k,m,l,n,x,null,g,r.getMonth()+1,r.getFullYear(),
r,r.valueOf()]);h+=1}while(h<=b.n&&0<g);g=z[z.length-1];f.summary.unadjustedBalance=g[11];f.summary.cf[c]=g[5];switch(f.roundingMethod){case a.ROUNDING_METHOD.RMLASTPMT:g[5]+=f.summary.unadjustedBalance,g[11]-=f.summary.unadjustedBalance,g[9]+=f.summary.unadjustedBalance}f.summary.totalNDebits[c]=h-1;f.summary.totalNCredits[c]=1;f.summary.lastDebitDateStr[c]=z[0][4];f.summary.lastCreditDateStr[c]=g[4];c===a.schedule.schedule2?T=z:R=z}c===a.schedule.schedule2&&(R=R.concat(T),R.sort(),Q(R,1));return R}};
f.XPMT_SCHEDULE={calc:function(a,c,d,e){E(a,c,d,e);return R}};f.SAVINGS_SCHEDULE={calc:function(b){var c=void 0,h,g,k,m,l,B,q,v=1,E,n,A=q=0;h=[];var x=new Date(0),C=new Date(0),r=[];if(void 0===c||null===c)c=a.schedule.schedule1;if(D(b)){f.summary.totalNDebits[c]=0;f.summary.totalNCredits[c]=0;f.summary.NYears=0;f.summary.nominalRate[c]=b.nominalRate;f.summary.pmtFreq=b.pmtFreq;f.summary.cmpFreq=b.cmpFreq;f.summary.amortMthd=b.amortMthd;G(b);m=d(b);A=g=b.pv;0<g?(E=g,n=0,f.summary.totalNCredits[c]+=
1):0>g?(n=g,E=0,f.summary.totalNDebits[c]+=1):n=E=0;a.dateMath.setRefDate(b.fDate);x.setTime(b.oDate.getTime());l=a.dateMath.dateToDateStr(x,a.dateConventions);r.push(["","",a.ROW_TYPES.DETAIL,"0:"+v,l,g,E,n,q,null,A,g,x.getMonth()+1,x.getFullYear(),x,x.valueOf()]);h=1;C.setTime(b.fDate.getTime());l=a.dateMath.dateToDateStr(C,a.dateConventions);k=b.cf;0<k?(E=k,n=0,f.summary.totalNCredits[c]+=1):0>k?(n=k,E=0,f.summary.totalNDebits[c]+=1):n=E=0;b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?
q=a.roundMoney(u(g,J,K,m)):(q=a.dateMath.countPeriods(x,C,b.pmtFreq).days,q=a.roundMoney(e(g,q,b.cmpFreq)));q=a.roundMoney(q);A=a.roundMoney(k+q);g=a.roundMoney(g+q+b.cf);r.push(["","",a.ROW_TYPES.DETAIL,h+":"+v,l,k,E,n,q,null,A,g,C.getMonth()+1,C.getFullYear(),C,C.valueOf()]);m=1;h=2;do x.setTime(C.getTime()),C.setTime(a.dateMath.addPeriods(C,1,b.pmtFreq)),b.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&b.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?q=a.roundMoney(u(g,0,0,m)):(q=a.dateMath.countPeriods(x,C,b.pmtFreq).days,
q=a.roundMoney(e(g,q,b.cmpFreq))),q=a.roundMoney(q),A=a.roundMoney(k+q),g=a.roundMoney(g+q+b.cf),l=a.dateMath.dateToDateStr(C,a.dateConventions),0!==n&&(f.summary.totalNDebits[c]+=1),0!==E&&(f.summary.totalNCredits[c]+=1),1===h%a.PPY[b.pmtFreq]&&(v+=1,f.summary.NYears=v),B=h+":"+v,r.push(["","",a.ROW_TYPES.DETAIL,B,l,k,E,n,q,null,A,g,C.getMonth()+1,C.getFullYear(),C,C.valueOf()]),h+=1;while(h<=b.n&&0<g);h=r[r.length-1];if(0>g)switch(f.summary.unadjustedBalance=h[11],f.roundingMethod){case a.ROUNDING_METHOD.RMLASTPMT:h[5]-=
f.summary.unadjustedBalance,h[11]-=f.summary.unadjustedBalance,h[7]-=f.summary.unadjustedBalance}f.summary.lastDebitDateStr[c]=r[0][4];f.summary.lastCreditDateStr[c]=h[4];Q(r);c===a.schedule.schedule2?T=r:R=r}return R}};f.MORTGAGE_SCHEDULE={calc:function(a){h(a);return R}};return f}(LIB$);/*
 Copyright 2016 Pine Grove Software, LLC
 financial-calculators.com
 pine-grove.com
 interface.schedules_and_charts.js
*/
var SC$=function(a,d){var G=a||{},u="Normal;Canadian;Fixed Principal;Interest Only;No Interest;Rule-of-78s".split(";"),e='<style type="text/css" media="screen">@font-face{font-family:"Roboto";font-style:normal;font-weight:400;src:local("Roboto"),local("Roboto-Regular"),url(https://financial-calculators.com/fonts/Roboto/roboto-regular-webfont.eot),url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Roboto/roboto-regular-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Roboto/roboto-regular-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Roboto/roboto-regular-webfont.svg#robotoregular) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Roboto";font-style:italic;font-weight:400;src:local("Roboto Italic"),local("Roboto-Italic"),url(https://financial-calculators.com/fonts/Roboto/roboto-italic-webfont.eot),url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Roboto/roboto-italic-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Roboto/roboto-italic-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Roboto/roboto-italic-webfont.svg#robotoitalic) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Roboto";font-style:normal;font-weight:700;src:local("Roboto Bold"),local("Roboto-Bold"),url(https://financial-calculators.com/fonts/Roboto/roboto-bold-webfont.eot),url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Roboto/roboto-bold-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Roboto/roboto-bold-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Roboto/roboto-bold-webfont.svg#robotobold) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Roboto";font-style:italic;font-weight:700;src:local("Roboto Bold Italic"),local("Roboto-BoldItalic"),url(https://financial-calculators.com/fonts/Roboto/roboto-bolditalic-webfont.eot),url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Roboto/roboto-bolditalic-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Roboto/roboto-bolditalic-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Roboto/roboto-bolditalic-webfont.svg#robotobold) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Source Code Pro";font-style:normal;font-weight:400;src:local("Source Code Pro"),local("SourceCodePro-Regular"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-regular-webfont.eot),url(https://fonts.gstatic.com/s/sourcecodepro/v6/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-regular-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-regular-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-regular-webfont.svg#source_code_proregular) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Source Code Pro";font-style:italic;font-weight:400;src:local("Source Code Pro Italic"),local("source_code_proitalic"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.eot),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.svg#source_code_proitalic) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Source Code Pro";font-style:normal;font-weight:600;src:local("Source Code Pro Semibold"),local("SourceCodePro-Semibold"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semibold-webfont.eot),url(https://fonts.gstatic.com/s/sourcecodepro/v6/leqv3v-yTsJNC7nFznSMqSOFnW3Jk0f09zW_Yln67Ac.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semibold-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semibold-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semibold-webfont.svg#source_code_prosemibold) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Source Code Pro";font-style:italic;font-weight:600;src:local("Source Code Pro Semibold Italic"),local("source_code_proSBdIt"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.eot),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.svg#source_code_prosemibold_italic) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}</style>',
e=e+'<style type="text/css" media="print">@font-face{font-family:"Roboto";font-style:normal;font-weight:400;src:local("Roboto"),local("Roboto-Regular"),url(https://financial-calculators.com/fonts/Roboto/roboto-regular-webfont.eot),url(https://fonts.gstatic.com/s/roboto/v15/CWB0XYA8bzo0kSThX0UTuA.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Roboto/roboto-regular-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Roboto/roboto-regular-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Roboto/roboto-regular-webfont.svg#robotoregular) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Roboto";font-style:italic;font-weight:400;src:local("Roboto Italic"),local("Roboto-Italic"),url(https://financial-calculators.com/fonts/Roboto/roboto-italic-webfont.eot),url(https://fonts.gstatic.com/s/roboto/v15/vPcynSL0qHq_6dX7lKVByfesZW2xOQ-xsNqO47m55DA.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Roboto/roboto-italic-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Roboto/roboto-italic-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Roboto/roboto-italic-webfont.svg#robotoitalic) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Roboto";font-style:normal;font-weight:700;src:local("Roboto Bold"),local("Roboto-Bold"),url(https://financial-calculators.com/fonts/Roboto/roboto-bold-webfont.eot),url(https://fonts.gstatic.com/s/roboto/v15/d-6IYplOFocCacKzxwXSOFtXRa8TVwTICgirnJhmVJw.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Roboto/roboto-bold-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Roboto/roboto-bold-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Roboto/roboto-bold-webfont.svg#robotobold) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Roboto";font-style:italic;font-weight:700;src:local("Roboto Bold Italic"),local("Roboto-BoldItalic"),url(https://financial-calculators.com/fonts/Roboto/roboto-bolditalic-webfont.eot),url(https://fonts.gstatic.com/s/roboto/v15/t6Nd4cfPRhZP44Q5QAjcC44P5ICox8Kq3LLUNMylGO4.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Roboto/roboto-bolditalic-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Roboto/roboto-bolditalic-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Roboto/roboto-bolditalic-webfont.svg#robotobold) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Source Code Pro";font-style:normal;font-weight:400;src:local("Source Code Pro"),local("SourceCodePro-Regular"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-regular-webfont.eot),url(https://fonts.gstatic.com/s/sourcecodepro/v6/mrl8jkM18OlOQN8JLgasD9V_2ngZ8dMf8fLgjYEouxg.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-regular-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-regular-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-regular-webfont.svg#source_code_proregular) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Source Code Pro";font-style:italic;font-weight:400;src:local("Source Code Pro Italic"),local("source_code_proitalic"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.eot),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-it-webfont.svg#source_code_proitalic) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Source Code Pro";font-style:normal;font-weight:600;src:local("Source Code Pro Semibold"),local("SourceCodePro-Semibold"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semibold-webfont.eot),url(https://fonts.gstatic.com/s/sourcecodepro/v6/leqv3v-yTsJNC7nFznSMqSOFnW3Jk0f09zW_Yln67Ac.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semibold-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semibold-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semibold-webfont.svg#source_code_prosemibold) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}@font-face{font-family:"Source Code Pro";font-style:italic;font-weight:600;src:local("Source Code Pro Semibold Italic"),local("source_code_proSBdIt"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.eot),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.woff2) format("woff2"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.woff) format("woff"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.ttf) format("truetype"),url(https://financial-calculators.com/fonts/Source-Code-Pro/sourcecodepro-semiboldit-webfont.svg#source_code_prosemibold_italic) format("svg");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215,U+E0FF,U+EFFD,U+F000}</style>',
k='<style type="text/css" media="screen">',k=k+'html,body{margin:0;padding:0 0 38px;color:#333;height:100%;min-height:700px;width:100%;min-width:320px;font-family:"Source Code Pro",monospace; font-size:8px; font-weight:400} tr {line-height: 1.42857143} @media (min-width: 569px) {html,body{font-size:12px}} @media (min-width: 768px) {html,body{font-size:14px}} .label {font-family: "Roboto", sans-serif;} .medium {font-weight: 600; font-style: italic} .bold {font-weight: 700} .center {text-align: center} .left {text-align: left} .right {text-align: right} .wrapper {padding:1px; width:100% height: 100%} table {width: 100%; border-collapse:collapse; margin-bottom: 20px;} #rpt tbody tr.totals, #rpt tbody tr:nth-child(even).totals {background-color: transparent; color:#333;} #rpt tbody tr:nth-child(even) {background: #FCFFFF;} #rpt tbody tr:hover, #rpt tbody tr:hover.totals {background: #303E64; color: #fff; font-weight:400} #rpt tbody::after {content: ""; display: block; height: 29px;} .cHead {background: #303E64; color: #fff} td {padding: 5px 5px;} .spcr {width: 2%} .hCell {width: 24%} .rpt_title {width: 100%; font-style: italic; font-size: 120%} .rpt_footer {width: 100%; font-style: italic; font-size: 90%;} .cNPeriod {width: 12%;} .cDate {width: 12%} .btn {display: inline-block; margin-bottom: 0; font-weight: normal; vertical-align: middle; touch-action: manipulation; cursor: pointer; background-image: none; border: 1px solid transparent; white-space: nowrap; padding: 6px 12px; font-size: 100%; line-height: 1.42857143; border-radius: 4px; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; } .btn-primary {color: #fff; background-color: #303e64; border-color: #283353;} .btn-primary:focus, .btn-primary.focus {color: #ffffff; background-color: #1f2942; border-color: #000000; } .btn-primary:hover {color: #ffffff; background-color: #1f2942; border-color: #141a29; } .btn-primary:active, .btn-primary.active, .open > .dropdown-toggle.btn-primary { color: #ffffff; background-color: #1f2942; border-color: #141a29;} .btn-row {padding: 15px 0 5px; width:100%} td.brder {border-top: 1px solid #303E64} #btnPrint {margin-right:15px} #btnCopy {margin-left:15px} tr.empty {background-color: transparent !important; color:#333 !important;} ',
k=k+"</style>",g='<style type="text/css" media="print">',g=g+'@page {size:auto; margin: 0.5in} html,body{margin:0;padding:0 0 28.5pt;color:#333; height:100%; width:100%; font-family: "Source Code Pro", monospace; font-size:9pt; font-weight: normal} .label {font-family: "Roboto", sans-serif;} .medium {font-weight: 600; font-style: italic} .bold {font-weight: 700} .center {text-align: center} .left {text-align: left} .right {text-align: right} .wrapper {padding:7.5pt} table {width: 100%; border-collapse:collapse; margin-bottom: 15pt;} #rpt tbody tr.totals, #rpt tbody tr:nth-child(even).totals {background-color: transparent; color:#333;} #rpt tbody tr:nth-child(even) {background: #FCFFFF;} #rpt tbody::after {content: ""; display: block; height: 21.75pt;} .cHead { color: #fff; background: #303E64; -webkit-print-color-adjust: exact} td {padding: 3.75pt} tbody td {padding: 0.1pt 3.75pt;} .spcr {width: 2%} .hCell {width: 24%} .rpt_title {width: 100%; font-style: italic; font-size: 120%} .rpt_footer {width: 100%; font-style: italic; font-size: 90%;} .cNPeriod {width: 12%;} .cDate {width: 12%} td.brder {border-top: 0.25pt solid #303E64} tr.empty {background-color: transparent !important; color:#333 !important;} .btn-row {display:none;} tfoot tr td {page-break-inside: avoid} ',
g=g+"</style></head>",l=function(c){var l,B,E,h,f,H,G,v,q,P,I,C,K,J,U;E=new a.StringBuffer;h=new a.StringBuffer;l=c.length-1;if(0!==l){q=c[0];P=q[4];v=a.formatLocalFloat(q[11],a.moneyConventions,2);B=a.formatLocalFloat(100*a.summary.nominalRate[a.schedule.schedule1],a.rateConventions,4);q=c[1];G=q[4];f=a.formatLocalFloat(q[5],a.moneyConventions,2);H=a.STR_FREQUENCIES[a.summary.pmtFreq];q=c[c.length-1];C=a.formatLocalFloat(q[8],a.moneyConventions,2);K=a.formatLocalFloat(q[5],a.moneyConventions,2);
I=a.summary.lastCreditDateStr[a.schedule.schedule1];q=a.formatLocalFloat(a.summary.totalNDebits[a.schedule.schedule1],a.numConventions,0);J=a.formatLocalFloat(a.summary.unadjustedBalance,a.moneyConventions,2);J=a.summary.roundingMethod===a.ROUNDING_METHOD.RMIGNORE&&0>a.summary.unadjustedBalance?"Last interest amount increased by "+J+" due to rounding":a.summary.roundingMethod===a.ROUNDING_METHOD.RMIGNORE&&0<a.summary.unadjustedBalance?"Last interest amount decreased by "+J+" due to rounding":a.summary.roundingMethod===
a.ROUNDING_METHOD.RMLASTPMT&&0>a.summary.unadjustedBalance?"Last payment amount decreased by "+J+" due to rounding":a.summary.roundingMethod===a.ROUNDING_METHOD.RMLASTPMT&&0<a.summary.unadjustedBalance?"Last payment amount increased by "+J+" due to rounding":"";U=a.summary.cmpFreq>=a.CMP_FREQUENCY.WEEKLY&&a.summary.cmpFreq<=a.CMP_FREQUENCY.ANNUALLY?"Calculation method:&nbsp;"+u[a.summary.amortMthd]:"Calculation method:&nbsp;"+u[a.summary.amortMthd]+", "+a.DAYS_PER_YEAR[a.summary.DIY]+"&nbsp;days per year";
h.append("<table>");h.append("<thead>");h.append('<tr class="label rpt_title center bold"><td colspan="6">Loan Summary</td></tr>');h.append('<tr class="empty"><td colspan="6"></td></tr>');h.append("</thead>");h.append("<tbody>");h.append('<tr><td class="label hCell">Loan Amount:</td><td class="right">'+v+'</td><td class="spcr">&nbsp;</td><td class="spcr">&nbsp;</td><td class="label hCell">Number of Payments:</td><td class="right">'+q+"</td></tr>");h.append('<tr><td class="label hCell">Annual Interest Rate:</td><td class="right">'+
B+'</td><td class="spcr">&nbsp;</td><td class="spcr">&nbsp;</td><td class="label hCell">Periodic Payment:</td><td class="right">'+f+"</td></tr>");h.append('<tr><td class="label hCell">Loan Date:</td><td class="right">'+P+'</td><td class="spcr">&nbsp;</td><td class="spcr">&nbsp;</td><td class="label hCell">1st Payment Due:</td><td class="right">'+G+"</td></tr>");h.append('<tr><td class="label hCell">Payment Frequency:</td><td class="right">'+H+'</td><td class="spcr">&nbsp;</td><td class="spcr">&nbsp;</td><td class="label hCell">Last Payment Due:</td><td class="right">'+
I+"</td></tr>");h.append('<tr><td class="label hCell">Total Interest Due:</td><td class="right">'+C+'</td><td class="spcr">&nbsp;</td><td class="spcr">&nbsp;</td><td class="label hCell">Total All Payments:</td><td class="right">'+K+"</td></tr>");h.append("</tbody>");h.append("</table>");h.append('<table id="rpt">');h.append("<thead>");h.append('<tr class="label rpt_title center bold"><td colspan="6">Payment Schedule</td></tr>');h.append('<tr class="empty"><td colspan="6"></td></tr>');h.append('<tr class="label cHead"><td class="cNPeriod">#/Year</td><td class="cDate center">Date</td><td class="right">Payment</td><td class="right">Interest</td><td class="right">Principal</td><td class="right">Balance</td></tr>');
h.append("</thead>");h.append("<tfoot>");h.append('<tr class="label rpt_footer left"><td colspan="2">'+J+'</td><td colspan="2"></td><td colspan="2" class="right" style="vertical-align: text-top">'+U+"</td></tr>");h.append('<tr class="label rpt_footer center"><td colspan="6">financial-calculators.com</td></tr>');h.append("</tfoot>");h.append("<tbody>");for(B=0;B<=l;B+=1)q=c[B],C=0<B?q[3]:"Loan:",P=q[4],f=a.formatLocalFloat(q[5],a.numConventions,2),H=a.formatLocalFloat(q[8],a.numConventions,2),G=a.formatLocalFloat(q[9],
a.numConventions,2),v=a.formatLocalFloat(q[11],a.numConventions,2),q[2]===a.ROW_TYPES.DETAIL?h.append('<tr><td class="cNPeriod">'+C+'</td><td class="cDate center">'+P+'</td><td class="right">'+f+'</td><td class="right">'+H+'</td><td class="right">'+G+'</td><td class="right">'+v+"</td></tr>"):q[2]===a.ROW_TYPES.ANNUAL_TOTALS?h.append('<tr class="totals medium"><td class="cDate right" colspan="2">'+C+'</td><td class="right brder">'+f+'</td><td class="right brder">'+H+'</td><td class="right brder">'+
G+"</td><td></td></tr>"):(h.append('<tr class="totals medium"><td class="cDate right" colspan="2">'+C+'</td><td class="right">'+f+'</td><td class="right">'+H+'</td><td class="right">'+G+"</td><td></td></tr>"),h.append('<tr class="empty"><td colspan="6"></td></tr>'));h.append("</tbody>");h.append("</table>")}d.fancybox.open({type:"iframe",content:'<iframe id="rptFrame" name="rptFrame" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" src="about:blank"></iframe>',autoSize:!1,minHeight:"290",
minWidth:"508",maxWidth:"1024",width:"80%",height:"80%",scrolling:"no",scrollOutside:!1,iframe:{scrolling:"no"},beforeLoad:function(){d("body").css({"overflow-y":"hidden"})},beforeShow:function(){d(".fancybox-wrap").append('<div id="fancy_print"></div>');d("#fancy_print").bind("click",function(){a.call_Print2("rptFrame")})},afterClose:function(){d("body").css({"overflow-y":"visible"})}});E.append("<!DOCTYPE html>");E.append('<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1">');
E.append("<title>Your Personalized Loan Schedule</title>");E.append(e);E.append(k);E.append(g);E.append('<body><div class="wrapper">');E.append(h.toString());E.append('<div class="btn-row center"><button onclick=\'var target = parent.document.getElementById(window.name); try {target.contentWindow.document.execCommand("print", false, null);} catch(e) {target.contentWindow.print();} return false;\' id="btn" class="btn btn-primary">Print</button></div>');E.append("</div></body></html>");c=document.getElementById("rptFrame");
c=c.contentWindow.document||c.contentDocument;c.open();c.write(E.toString());c.close()},c={L:0,chart0:null,chart1:null,chart2:null,chart3:null,years:null,chart0Title:"",chart1Title:"",chart2Title:"",chart3Title:"",bs_primary_blue:"#337ab7",bs_info_blue:"#5bc0de",bs_success_green:"#5cb85c",bs_orange_warning:"#f0ad4e",bs_red_danger:"#d9534f",EVENT_DATE:0,LOAN_NO:1,ROW_TYPE:2,PER_STR:3,DATE_STR:4,CF:5,CREDIT:6,DEBIT:7,INT:8,PRIN:9,NET:10,BAL:11,MONTH:12,YEAR:13,d1:[],d2:[],d3:[],d4:[],d5:[],d6:[],d7:[],
d8:[],d9:[],d10:[],d11:[],category:[],interest:0,interest2:0,prin:0,prin2:0,xpmt:0,rate:0,payments:0,payments2:0,balance:0,strDate:"01/01/1999",strDate2:"01/01/1999",strDate2bi:"01/01/1999",kStr:""===a.moneyConventions.ccy_r?"k":" k",strHTML3Charts:'<div style="overflow:auto; height:100%"><div class="chartContainer" style="width:99%; height:440px; margin-top:40px;"><div id="chart0" style="width:95%; height:100%; margin:0 auto;"></div></div><div class="chart-footer"><div class="chart-footer-left">Pass mouse over bars or points for details.</div><div class="chart-footer-right">Click an item in the legend to remove.</div></div><div class="chartContainer" style="width:99%; height:400px; margin-top:40px;"><div id="chart1" style="width:95%; height:100%; margin:0 auto;"></div></div><div class="chart-footer"><div class="chart-footer-left">Pass mouse over bars or points for details.</div><div class="chart-footer-right">Click an item in the legend to remove.</div></div><div class="chartContainer" style="width:99%; height:400px; margin-top:40px;"><div id="chart2" style="width:95%; height:100%; margin:0 auto;"></div></div><div class="chart-footer"><div class="chart-footer-left">Mouse over slice for % details. Click to explode.</div></div></div>',
strHTML4Charts:'<div style="overflow:auto; height:100%"><div class="chartContainer" style="width:99%; height:440px; margin-top:40px;"><div id="chart0" style="width:95%; height:100%; margin:0 auto;"></div></div><div class="chart-footer"><div class="chart-footer-left">Pass mouse over bars or points for details.</div><div class="chart-footer-right">Click an item in the legend to remove.</div></div><div class="chartContainer" style="width:99%; height:400px; margin-top:40px;"><div id="chart1" style="width:95%; height:100%; margin:0 auto;"></div></div><div class="chart-footer"><div class="chart-footer-left">Pass mouse over bars or points for details.</div><div class="chart-footer-right">Click an item in the legend to remove.</div></div><div class="chartContainer" style="width:99%; height:400px; margin-top:40px;"><div id="chart2" style="width:95%; height:100%; margin:0 auto;"></div></div><div class="chart-footer"><div class="chart-footer-left">Mouse over slice for % details. Click to explode.</div></div><div class="chartContainer" style="width:99%; height:400px; margin-top:40px;"><div id="chart3" style="width:95%; height:100%; margin:0 auto;"></div></div><div class="chart-footer"><div class="chart-footer-left">Mouse over slice for % details. Click to explode.</div> </div></div>',
createAnnualTotalChart:function(){c.chart0=null;document.getElementById("chart0").innerHTML="";c.chart0=new Highcharts.Chart({chart:{renderTo:"chart0",spacingTop:20,options3d:{enabled:!0}},title:{text:c.chart0Title},xAxis:{categories:c.category,title:{text:"Year End",style:{fontWeight:"normal",color:"black"}}},tooltip:{formatter:function(){return"<b>"+this.series.name+":</b> "+a.formatLocalFloat(this.y,a.moneyConventions,0)+"<br /><b>Year:</b> "+(this.point.x+1)}},credits:{enabled:!1},yAxis:{min:0,
title:{text:null,align:"high"},labels:{align:"right",enabled:!0,formatter:function(){return a.formatLocalFloat(this.value/1E3,a.moneyConventions,0)+c.kStr}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},plotOptions:{series:{stacking:"normal"}},series:[{type:"column",name:"Annual Interest",data:c.d1,color:c.bs_red_danger},{type:"column",name:"Annual Principal",data:c.d2,color:c.bs_success_green},{name:"Payments Total",data:c.d3,color:c.bs_primary_blue,
zIndex:100}]})},createAnnualXPmtTotalChart:function(){c.chart0=null;document.getElementById("chart0").innerHTML="";c.chart0=new Highcharts.Chart({chart:{renderTo:"chart0",spacingTop:20,options3d:{enabled:!0}},title:{text:c.chart0Title},xAxis:{categories:c.category,title:{text:"Year End",style:{fontWeight:"normal",color:"black"}}},tooltip:{formatter:function(){return"<b>"+this.series.name+":</b> "+a.formatLocalFloat(this.y,a.moneyConventions,0)+"<br /><b>Year:</b> "+(this.point.x+1)}},credits:{enabled:!1},
yAxis:{min:0,title:{text:null,align:"high"},labels:{align:"right",enabled:!0,formatter:function(){return a.formatLocalFloat(this.value/1E3,a.moneyConventions,0)+c.kStr}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},plotOptions:{series:{stacking:"normal"}},series:[{type:"column",name:"Annual Interest",data:c.d1,color:c.bs_red_danger},{type:"column",name:"Annual XPmt",data:c.d10,color:c.bs_primary_blue},{type:"column",name:"Annual Principal",data:c.d2,
color:c.bs_success_green},{name:"Payments Total",data:c.d3,color:c.bs_primary_blue,zIndex:100}]})},createAnnualSavingsTotalChart:function(){c.chart0=null;document.getElementById("chart0").innerHTML="";c.chart0=new Highcharts.Chart({chart:{renderTo:"chart0",spacingTop:20,options3d:{enabled:!0,alpha:0,beta:0,depth:70}},title:{text:"Annual Deposit, Withdrawal and Interest Totals"},xAxis:{categories:c.category,title:{text:"Year End",style:{fontWeight:"normal",color:"black"}}},tooltip:{formatter:function(){return"<b>"+
this.series.name+":</b> "+a.formatLocalFloat(this.y,a.moneyConventions,0)+"<br /><b>Year:</b> "+(this.point.x+1)}},credits:{enabled:!1},yAxis:{title:{text:null,align:"high"},labels:{align:"right",enabled:!0,formatter:function(){return a.formatLocalFloat(this.value/1E3,a.moneyConventions,0)+c.kStr}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},plotOptions:{series:{stacking:"normal"}},series:[{type:"column",name:"Annual Interest",data:c.d1,color:c.bs_info_blue},
{type:"column",name:"Annual Deposit",data:c.d8,color:c.bs_primary_blue},{type:"column",name:"Annual Withdrawal",data:c.d3,color:c.bs_success_green},{type:"line",name:"Change in Balance",data:c.d2,color:c.bs_red_danger,zIndex:100}]})},createAccumulatedTotalChart:function(){c.chart1=null;document.getElementById("chart1").innerHTML="";c.chart1=new Highcharts.Chart({chart:{renderTo:"chart1",spacingTop:20,options3d:{enabled:!0}},title:{text:c.chart1Title},xAxis:{categories:c.category,title:{text:"Year End",
style:{fontWeight:"normal",color:"black"}}},tooltip:{formatter:function(){return"<b>"+this.series.name+":</b> "+a.formatLocalFloat(this.y,a.moneyConventions,0)+"<br /><b>Year:</b> "+(this.point.x+1)}},credits:{enabled:!1},yAxis:{min:0,title:{text:null,align:"high"},labels:{align:"right",enabled:!0,formatter:function(){return a.formatLocalFloat(this.value/1E3,a.moneyConventions,0)+c.kStr}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},plotOptions:{column:{stacking:"normal"}},
series:[{type:"column",name:"Running Interest",data:c.d4,color:c.bs_info_blue},{type:"column",name:"Running Principal",data:c.d5,color:c.bs_primary_blue},{name:"Payments Total",data:c.d6,color:c.bs_red_danger,zIndex:100},{name:"Loan Balance",data:c.d7,color:"black",zIndex:101}]});return!0},createAccumulatedXPmtTotalChart:function(){c.chart1=null;document.getElementById("chart1").innerHTML="";c.chart1=new Highcharts.Chart({chart:{renderTo:"chart1",spacingTop:20,options3d:{enabled:!0}},title:{text:c.chart1Title},
xAxis:{categories:c.category,title:{text:"Year End",style:{fontWeight:"normal",color:"black"}}},tooltip:{formatter:function(){return"<b>"+this.series.name+":</b> "+a.formatLocalFloat(this.y,a.moneyConventions,0)+"<br /><b>Year:</b> "+(this.point.x+1)}},credits:{enabled:!1},yAxis:{min:0,title:{text:null,align:"high"},labels:{align:"right",enabled:!0,formatter:function(){return a.formatLocalFloat(this.value/1E3,a.moneyConventions,0)+c.kStr}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,
enabled:!0,backgroundColor:"#f9f9f9"},plotOptions:{column:{stacking:"normal"}},series:[{type:"column",name:"Running Interest",data:c.d4,color:c.bs_info_blue},{type:"column",name:"Running XPmts",data:c.d11,color:c.bs_red_danger},{type:"column",name:"Running Principal",data:c.d5,color:c.bs_primary_blue},{name:"Payments Total",data:c.d6,color:c.bs_red_danger,zIndex:100},{name:"Loan Balance",data:c.d7,color:"black",zIndex:101}]});return!0},createAccumulatedBiweeklyTotalChart:function(){c.chart0=null;
document.getElementById("chart0").innerHTML="";c.chart0=new Highcharts.Chart({chart:{renderTo:"chart0",spacingTop:20,options3d:{enabled:!0}},title:{text:c.chart0Title},xAxis:{categories:c.category,title:{text:"Year End",style:{fontWeight:"normal",color:"black"}}},tooltip:{formatter:function(){return"<b>"+this.series.name+":</b> "+a.formatLocalFloat(this.y,a.moneyConventions,0)+"<br /><b>Year:</b> "+(this.point.x+1)}},credits:{enabled:!1},yAxis:{min:0,title:{text:null,align:"high"},labels:{align:"right",
enabled:!0,formatter:function(){return a.formatLocalFloat(this.value/1E3,a.moneyConventions,0)+c.kStr}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},plotOptions:{column:{stacking:"normal"}},series:[{type:"column",name:"Annual Interest",data:c.d1,color:c.bs_red_danger},{type:"column",name:"Annual Principal",data:c.d2,color:c.bs_success_green},{name:"Payments Total",data:c.d3,color:c.bs_primary_blue,zIndex:100},{name:"Loan Balance",data:c.d8,color:"black",
zIndex:101}]})},createAccumulatedSavingsTotalChart:function(){c.chart1=null;document.getElementById("chart1").innerHTML="";c.chart1=new Highcharts.Chart({chart:{renderTo:"chart1",spacingTop:20,options3d:{enabled:!0}},title:{text:"Accumulated Deposits, Interest and Withdrawals with Balance"},xAxis:{categories:c.category,title:{text:"Year End",style:{fontWeight:"normal",color:"black"}}},tooltip:{formatter:function(){return"<b>"+this.series.name+":</b> "+a.formatLocalFloat(this.y,a.moneyConventions,
0)+"<br /><b>Year:</b> "+(this.point.x+1)}},credits:{enabled:!1},yAxis:{title:{text:null,align:"high"},labels:{align:"right",enabled:!0,formatter:function(){return a.formatLocalFloat(this.value/1E3,a.moneyConventions,0)+c.kStr}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},plotOptions:{column:{stacking:"normal"}},series:[{type:"column",name:"Running Interest",data:c.d4,color:c.bs_info_blue},{type:"column",name:"Running Deposit",data:c.d9,color:c.bs_primary_blue},
{type:"column",name:"Running Withdrawal",data:c.d6,color:c.bs_red_danger},{name:"Balance",data:c.d7,color:"black",zIndex:100}]});return!0},createPIPieChart:function(){c.chart2=null;document.getElementById("chart2").innerHTML="";c.chart2=new Highcharts.Chart({chart:{renderTo:"chart2",spacingBottom:20,options3d:{enabled:!0,alpha:45,beta:0}},title:{text:c.chart2Title},tooltip:{formatter:function(){return"<em>"+this.point.name+"</em>: "+a.formatLocalFloat(Math.round(10*this.percentage)/10,a.rateConventions,
1)}},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",formatter:function(){return"<em>"+this.point.name+"</em>:<br />"+a.formatLocalFloat(this.y,a.moneyConventions,0)}}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},labels:{items:[{html:"Loan Date: "+c.strDate,style:{left:"0",top:"-20px",color:"black"}},{html:"Interest Rate: "+a.formatLocalFloat(c.rate,
a.rateConventions,4),style:{left:"0",top:"20px",color:"black"}},{html:"Payments Total: "+a.formatLocalFloat(c.payments,a.moneyConventions,0),style:{left:"0",top:"40px",color:"black"}},{html:"Payoff Date: "+c.strDate2,style:{left:"0",top:"0",color:"black"}}]},series:[{type:"pie",name:"Principal and interest breakdown.",data:[{name:"Total Interest",color:c.bs_red_danger,y:c.interest},{name:"Total Principal",color:c.bs_success_green,y:c.prin}]}]});return!0},createXPmtPIPieChart:function(){c.chart2=null;
document.getElementById("chart2").innerHTML="";c.chart2=new Highcharts.Chart({chart:{renderTo:"chart2",spacingBottom:20,options3d:{enabled:!0,alpha:45,beta:0}},title:{text:c.chart2Title},tooltip:{formatter:function(){return"<em>"+this.point.name+"</em>: "+a.formatLocalFloat(Math.round(10*this.percentage)/10,a.rateConventions,1)}},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",formatter:function(){return"<em>"+
this.point.name+"</em>:<br />"+a.formatLocalFloat(this.y,a.moneyConventions,0)}}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},labels:{items:[{html:"Loan Date: "+c.strDate,style:{left:"0",top:"-20px",color:"black"}},{html:"Interest Rate: "+a.formatLocalFloat(c.rate,a.rateConventions,4),style:{left:"0",top:"20px",color:"black"}},{html:"Payments Total: "+a.formatLocalFloat(c.payments,a.moneyConventions,0),style:{left:"0",top:"40px",color:"black"}},
{html:"Payoff Date: "+c.strDate2,style:{left:"0",top:"0",color:"black"}}]},series:[{type:"pie",name:"Principal and interest breakdown.",data:[{name:"Total Interest",color:c.bs_red_danger,y:c.interest},{name:"Scheduled Principal",color:c.bs_success_green,y:c.prin},{name:"Prepaid Principal",color:c.bs_info_blue,y:c.xpmt}]}]});return!0},createBiweeklyPIPieChart:function(){c.chart3=null;document.getElementById("chart3").innerHTML="";c.chart3=new Highcharts.Chart({chart:{renderTo:"chart3",spacingBottom:20,
options3d:{enabled:!0,alpha:45,beta:0}},title:{text:c.chart3Title},tooltip:{formatter:function(){return"<em>"+this.point.name+"</em>: "+a.formatLocalFloat(Math.round(10*this.percentage)/10,a.rateConventions,1)}},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",formatter:function(){return"<em>"+this.point.name+"</em>:<br />"+a.formatLocalFloat(this.y,a.moneyConventions,0)}}}},legend:{verticalAlign:"top",
y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},labels:{items:[{html:"Loan Date: "+c.strDate,style:{left:"0",top:"-20px",color:"black"}},{html:"Interest Rate: "+a.formatLocalFloat(c.rate,a.rateConventions,4),style:{left:"0",top:"20px",color:"black"}},{html:"Payments Total: "+a.formatLocalFloat(c.payments2,a.moneyConventions,0),style:{left:"0",top:"40px",color:"black"}},{html:"Payoff Date: "+c.strDate2bi,style:{left:"0",top:"0",color:"black"}}]},series:[{type:"pie",name:"Principal and interest breakdown.",
data:[{name:"Total Interest",color:c.bs_info_blue,y:c.interest2},{name:"Total Principal",color:c.bs_primary_blue,y:c.prin2}]}]});return!0},createSavingsPIPieChart:function(){c.chart2=null;document.getElementById("chart2").innerHTML="";c.chart2=new Highcharts.Chart({chart:{renderTo:"chart2",spacingBottom:20,options3d:{enabled:!0,alpha:45,beta:0}},title:{text:"Total Deposits and Interest"},tooltip:{formatter:function(){return"<em>"+this.point.name+"</em>: "+a.formatLocalFloat(Math.round(10*this.percentage)/
10,a.rateConventions,1)}},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",formatter:function(){return"<em>"+this.point.name+"</em>:<br />"+a.formatLocalFloat(this.y,a.moneyConventions,0)}}}},legend:{verticalAlign:"top",y:25,shadow:!0,borderWidth:1,enabled:!0,backgroundColor:"#f9f9f9"},labels:{items:[{html:"Balance: "+a.formatLocalFloat(c.balance,a.moneyConventions,0),style:{left:"0",top:"40px",color:"black"}},
{html:"Interest Rate: "+a.formatLocalFloat(c.rate,a.rateConventions,4),style:{left:"0",top:"0",color:"black"}},{html:"Withdrawals Total: "+a.formatLocalFloat(c.payments,a.moneyConventions,0),style:{left:"0",top:"20px",color:"black"}},{html:"Last Date: "+c.strDate2,style:{left:"0",top:"-20px",color:"black"}}]},series:[{type:"pie",name:"Deposit and interest breakdown.",data:[{name:"Total Interest",color:c.bs_red_danger,y:c.interest},{name:"Deposits Total",color:c.bs_success_green,y:c.prin}]}]});return!0},
createLoanCharts:function(e){var g,k,l,h,f;l=0;g=e.length-1;c.years=e[g][13]-e[0][13]+1;for(k=0;k<=g;k+=1)h=e[k],h[2]===a.ROW_TYPES.ANNUAL_TOTALS||a.summary.pmtFreq===a.PMT_FREQUENCY.ANNUALLY&&h[2]!==a.ROW_TYPES.RUNNING_TOTALS?(c.d3.push(Math.round(h[5])),c.d1.push(Math.round(h[8])),c.d2.push(Math.round(h[9])),11>=c.years||0===l%3||0===l?c.category.push(h[13]):c.category.push(""),a.summary.pmtFreq===a.PMT_FREQUENCY.ANNUALLY&&(f=h[11]),l+=1):h[2]===a.ROW_TYPES.RUNNING_TOTALS?(c.d6.push(Math.round(h[5])),
c.d4.push(Math.round(h[8])),c.d5.push(Math.round(h[9])),c.d7.push(f)):f=Math.round(h[11]);h=e[g];c.interest=h[8];c.prin=h[9];c.payments=h[5];h=e[0];c.strDate=h[4];h=a.summary.pmtFreq!==a.PMT_FREQUENCY.ANNUALLY?e[g-2]:e[g-1];c.strDate2=h[4];c.rate=100*a.summary.nominalRate[a.schedule.schedule1];c.chart0Title="Annual Principal and Interest Totals";c.chart1Title="Accumulated Principal and Interest with Remaining Balance";c.chart2Title="Total Principal and Interest";d.fancybox.open({content:c.strHTML3Charts,
autoSize:!1,minHeight:"290",minWidth:"508",maxWidth:"1024",width:"80%",height:"80%",scrolling:"no",afterClose:function(){c.chart0&&c.chart0.destroy();c.chart1&&c.chart1.destroy();c.chart2&&c.chart2.destroy();c.d1=[];c.d2=[];c.d3=[];c.d4=[];c.d5=[];c.d6=[];c.d7=[];c.d8=[];c.d9=[];c.category=[]}});c.createAnnualTotalChart();c.createAccumulatedTotalChart();c.createPIPieChart()},createBiweeklyLoanCharts:function(e){var g,k,l,h,f,u;l=0;g=e.length-1;c.years=e[g][13]-e[0][13]+1;for(k=0;k<=g;k+=1)h=e[k],
h[1]===a.schedule.schedule1&&h[2]===a.ROW_TYPES.RUNNING_TOTALS?(c.d3.push(Math.round(h[5])),c.d1.push(Math.round(h[8])),c.d2.push(Math.round(h[9])),c.d8.push(u),11>=c.years||0===l%3||0===l?c.category.push(h[13]):c.category.push(""),l+=1):h[1]===a.schedule.schedule2&&h[2]===a.ROW_TYPES.RUNNING_TOTALS?(c.d6.push(Math.round(h[5])),c.d4.push(Math.round(h[8])),c.d5.push(Math.round(h[9])),c.d7.push(f)):h[1]===a.schedule.schedule1&&h[2]!==a.ROW_TYPES.ANNUAL_TOTALS?f=Math.round(h[11]):h[2]!==a.ROW_TYPES.ANNUAL_TOTALS&&
(u=Math.round(h[11]));c.chart0Title="Monthly Accumulated Principal and Interest with Remaining Balance";c.chart1Title="Biweekly Accumulated Principal and Interest with Remaining Balance";c.chart2Title="Monthly Total Principal and Interest";c.chart3Title="Biweekly Total Principal and Interest";c.strDate=a.summary.firstDebitDateStr;c.rate=100*a.summary.nominalRate;c.strDate2=a.summary.lastCreditDateStr[a.schedule.schedule1];c.strDate2bi=a.summary.lastCreditDateStr[a.schedule.schedule2];c.interest=a.summary.totalInterest[a.schedule.schedule1];
c.interest2=a.summary.totalInterest[a.schedule.schedule2];c.payments=a.summary.totalPmts[a.schedule.schedule1];c.payments2=a.summary.totalPmts[a.schedule.schedule2];h=e[g];c.prin=h[9];c.prin2=h[9];d.fancybox.open({content:c.strHTML4Charts,autoSize:!1,minHeight:"290",minWidth:"508",maxWidth:"1024",width:"80%",height:"80%",scrolling:"no",afterClose:function(){c.chart0&&c.chart0.destroy();c.chart1&&c.chart1.destroy();c.chart2&&c.chart2.destroy();c.chart3&&c.chart3.destroy();c.d1=[];c.d2=[];c.d3=[];c.d4=
[];c.d5=[];c.d6=[];c.d7=[];c.d8=[];c.category=[]}});c.createAccumulatedBiweeklyTotalChart();c.createAccumulatedTotalChart();c.createPIPieChart();c.createBiweeklyPIPieChart()},createXPmtLoanCharts:function(e){var g,k,l,h,f;l=0;g=e.length-1;c.years=e[g][13]-e[0][13]+1;for(k=0;k<=g;k+=1)h=e[k],h[2]===a.ROW_TYPES.ANNUAL_TOTALS||a.summary.pmtFreq===a.PMT_FREQUENCY.ANNUALLY&&h[2]!==a.ROW_TYPES.RUNNING_TOTALS?(c.d3.push(Math.round(h[5])),c.d1.push(Math.round(h[8])),c.d2.push(Math.round(h[9])-Math.round(h[14])),
c.d10.push(Math.round(h[14])),11>=c.years||0===l%3||0===l?c.category.push(h[13]):c.category.push(""),a.summary.pmtFreq===a.PMT_FREQUENCY.ANNUALLY&&(f=h[11]),l+=1):h[2]===a.ROW_TYPES.RUNNING_TOTALS?(c.d6.push(Math.round(h[5])),c.d4.push(Math.round(h[8])),c.d5.push(Math.round(h[9])-Math.round(h[14])),c.d11.push(Math.round(h[14])),c.d7.push(f)):f=Math.round(h[11]);h=e[g];c.interest=h[8];c.prin=h[9]-h[14];c.xpmt=h[14];c.payments=h[5];h=e[0];c.strDate=h[4];h=a.summary.pmtFreq!==a.PMT_FREQUENCY.ANNUALLY?
e[g-2]:e[g-1];c.strDate2=h[4];c.rate=100*a.summary.nominalRate[a.schedule.schedule1];c.chart0Title="Annual Principal and Interest Totals with Extra Payments";c.chart1Title="Accumulated Principal and Interest with Remaining Balance";c.chart2Title="Total Principal and Interest with Extra Payments";d.fancybox.open({content:c.strHTML3Charts,autoSize:!1,minHeight:"290",minWidth:"508",maxWidth:"1024",width:"80%",height:"80%",scrolling:"no",afterClose:function(){c.chart0&&c.chart0.destroy();c.chart1&&c.chart1.destroy();
c.chart2&&c.chart2.destroy();c.d1=[];c.d2=[];c.d3=[];c.d4=[];c.d5=[];c.d6=[];c.d7=[];c.d8=[];c.d9=[];c.d10=[];c.d11=[];c.category=[]}});c.createAnnualXPmtTotalChart();c.createAccumulatedXPmtTotalChart();c.createXPmtPIPieChart()},createSavingsCharts:function(e){var g,k,l,h,f;l=0;g=e.length-1;c.years=a.summary.NYears;for(k=0;k<=g;k+=1)h=e[k],h[2]===a.ROW_TYPES.ANNUAL_TOTALS||a.summary.pmtFreq===a.PMT_FREQUENCY.ANNUALLY&&h[2]!==a.ROW_TYPES.RUNNING_TOTALS?(c.d3.push(h[7]),c.d8.push(h[6]),c.d1.push(h[8]),
c.d2.push(h[10]),11>=c.years||0===l%3||0===l?c.category.push(h[13]):c.category.push(""),a.summary.pmtFreq===a.PMT_FREQUENCY.ANNUALLY&&(f=h[11]),l+=1):h[2]===a.ROW_TYPES.RUNNING_TOTALS?(c.d6.push(h[7]),c.d9.push(h[6]),c.d4.push(h[8]),c.d5.push(h[9]),c.d7.push(f)):f=h[11];h=e[g];c.interest=h[8];c.prin=h[6];c.payments=h[7];h=e[0];c.strDate=h[4];h=a.summary.pmtFreq!==a.PMT_FREQUENCY.ANNUALLY?e[g-2]:e[g-1];c.strDate2=h[4];c.balance=h[11];c.rate=100*a.summary.nominalRate[1];d.fancybox.open({content:c.strHTML3Charts,
autoSize:!1,minHeight:"290",minWidth:"508",maxWidth:"1024",width:"80%",height:"80%",scrolling:"no",afterClose:function(){c.chart0&&c.chart0.destroy();c.chart1&&c.chart1.destroy();c.chart2&&c.chart2.destroy();c.d1=[];c.d2=[];c.d3=[];c.d4=[];c.d5=[];c.d6=[];c.d7=[];c.d8=[];c.d9=[];c.category=[]}});c.createAnnualSavingsTotalChart();c.createAccumulatedSavingsTotalChart();c.createSavingsPIPieChart()}};G.showLoanSchedule=function(a){l(a)};G.showBiweeklySchedule=function(a){};G.showBridgeSchedule=function(a){};
G.showSavingsSchedule=function(a){};G.showLoanCharts=function(a){c.createLoanCharts(a)};G.showSavingsCharts=function(a){c.createSavingsCharts(a)};G.showBiweeklyLoanCharts=function(a){c.createBiweeklyLoanCharts(a)};G.showXPmtLoanCharts=function(a){c.createXPmtLoanCharts(a)};return G}(EQ$,jQuery);/*
 Copyright 2016 Pine Grove Software, LLC
 financial-calculators.com
 pine-grove.com
 interface.SHARED.js
*/
var GUI$=function(a,d){var G=d||{};G.show_help=function(){var d=360;570<document.documentElement.clientWidth&&(d=560);a.fancybox({href:"#hText",fitToView:!0,maxWidth:d,transitionIn:"none",transitionOut:"none",centerOnScroll:!0,titlePosition:"inside",beforeLoad:function(){a("body").css({"overflow-y":"hidden"})},afterClose:function(){a("body").css({"overflow-y":"visible"})}})};var u=function(e){d.zoomLevel=void 0===e||null===e?1:.5<d.zoomLevel+e&&1.5>d.zoomLevel+e?d.zoomLevel+e:d.zoomLevel;a("#calc-wrap").css({"-webkit-transform":"scale("+
d.zoomLevel+")","-moz-transform":"scale("+d.zoomLevel+")","-ms-transform":"scale("+d.zoomLevel+")","-o-transform":"scale("+d.zoomLevel+")",transform:"scale("+d.zoomLevel+")"})};a("#grow").click(function(){u(.1)});a("#shrink").click(function(){u(-.1)});a("#original").click(function(){u()});G.init_DAYSPERYEAR_Dlg=function(){switch(d.getSettings().DIY){case 0:document.getElementById("dpy360").checked=!0;break;case 1:document.getElementById("dpy364").checked=!0;break;case 2:document.getElementById("dpy365").checked=
!0}a("#DAYSPERYEAR").modal()};a("#DAYSPERYEAR_save").click(function(a){a.preventDefault();a=document.getElementById("dpy365").checked?d.DAYS_IN_YEAR.THREE_SIXTY_FIVE:document.getElementById("dpy364").checked?d.DAYS_IN_YEAR.THREE_SIXTY_FOUR:d.DAYS_IN_YEAR.THREE_SIXTY;d.setOptions({DIY:a})});G.init_CURRENCYDATE_Dlg=function(){switch(d.moneyConventions.ccy_format){case 0:document.getElementById("ccyUSD").checked=!0;break;case 1:document.getElementById("ccyUSD2").checked=!0;break;case 2:document.getElementById("ccyGBH").checked=
!0;break;case 3:document.getElementById("ccyNone").checked=!0;break;case 4:document.getElementById("ccyEUR1").checked=!0;break;case 5:document.getElementById("ccyEUR2").checked=!0;break;case 6:document.getElementById("ccyEUR3").checked=!0;break;case 7:document.getElementById("ccyEUR4").checked=!0}switch(d.dateConventions.date_format){case 0:document.getElementById("MMDDYY").checked=!0;break;case 1:document.getElementById("DDMMYY").checked=!0;break;case 2:document.getElementById("YYMMDD").checked=
!0}a("#CURRENCYDATE").modal()};a("#CURRENCYDATE_save").click(function(a){a.preventDefault();document.getElementById("ccyUSD").checked?d.resetNumConventions(d.CCY_FORMATS.USD1):document.getElementById("ccyUSD2").checked?d.resetNumConventions(d.CCY_FORMATS.USD2):document.getElementById("ccyGBH").checked?d.resetNumConventions(d.CCY_FORMATS.GBH):document.getElementById("ccyNone").checked?d.resetNumConventions(d.CCY_FORMATS.NON):document.getElementById("ccyEUR1").checked?d.resetNumConventions(d.CCY_FORMATS.EUR1):
document.getElementById("ccyEUR2").checked?d.resetNumConventions(d.CCY_FORMATS.EUR2):document.getElementById("ccyEUR3").checked?d.resetNumConventions(d.CCY_FORMATS.EUR3):document.getElementById("ccyEUR4").checked&&d.resetNumConventions(d.CCY_FORMATS.EUR4);document.getElementById("MMDDYY").checked?d.resetDateConventions(d.DATE_FORMATS.MDY):document.getElementById("DDMMYY").checked?d.resetDateConventions(d.DATE_FORMATS.DMY):document.getElementById("YYMMDD").checked&&d.resetDateConventions(d.DATE_FORMATS.YMD);
window.location.reload(!1)});a(".cr").html("\u00a9"+d.yearNow+' <a href="https://financial-calculators.com" target="_blank">financial-calculators.com</a>, all rights reserved');a("#CCY").html((""!==d.moneyConventions.ccy?d.moneyConventions.ccy:d.moneyConventions.ccy_r)+" : "+d.dateConventions.date_mask);a(function(){a('[data-toggle="tooltip"]').tooltip()});a("input").focus(function(){if("checkbox"===this.type||"radio"===this.type)return!1;this.setSelectionRange(0,999);return!1}).mouseup(function(){return!1});
document.getElementById("pop-up-help")&&a("#pop-up-help").addClass("pop-up");return G}(jQuery,LIB$);/*
 Copyright 2016 Pine Grove Software, LLC
 financial-calculators.com
 pine-grove.com
 interface.LOAN.js
*/
(function(a,d){function G(){e=new d.fin_params;e.pv=g.getUSNumber();e.n=l.getUSNumber();e.nominalRate=c.getUSNumber()/100;e.cf=-D.getUSNumber();e.pmtFreq=d.PMT_FREQUENCY.MONTHLY;e.cmpFreq=d.CMP_FREQUENCY.MONTHLY;e.pmtMthd=d.PMT_METHOD.ARREARS;e.amortMthd=d.AMORT_MTHD_EXT.NORMAL}function u(){var a,u,h;a=0;0===e.pv&&(a+=1);0===e.n&&(a+=1);0===e.nominalRate&&e.amortMthd!==k.NO_INTEREST&&(a+=1);0===e.cf&&(a+=1);if(0===a)return Q||alert('There are no unknown values\nSet the unknown value to "0".\nOr click "Payment Schedule" or "Charts".'),
null;if(1<a)return alert('There are too many unknown values.\nSet only one value to "0".'),null;0===e.pv&&(e.pv=d.roundMoney(d.PV.calc(e)),g.setValue(e.pv));0===e.n&&(e.n=d.roundMoney(d.N.calc(e)),l.setValue(e.n));0===e.nominalRate&&e.amortMthd!==k.NO_INTEREST&&(e.nominalRate=d.R.calc(e),c.setValue(Math.round(1E6*e.nominalRate)/1E4));0===e.cf&&(e.cf=d.roundMoney(d.CF.calc(e)),Infinity!==e.cf?D.setValue(-e.cf):e.cf=0);e.amortMthd===k.NO_INTEREST&&c.setValue(0);h=d.LOAN_SCHEDULE.calc(e,d.schedule.schedule1);
null!==h&&(a=h[h.length-1][5],u=h[h.length-1][8],0!==e.cf&&e.amortMthd!==k.INTEREST_ONLY?(document.getElementById("edInterest").value=d.formatLocalFloat(u,d.moneyConventions,2),document.getElementById("edTotalPI").value=d.formatLocalFloat(a,d.moneyConventions,2)):(0!==e.cf&&e.cmpFreq>d.CMP_FREQUENCY.DAILY&&e.cmpFreq<d.CMP_FREQUENCY.EXACT?document.getElementById("edInterest").value=d.formatLocalFloat(u,d.moneyConventions,2):document.getElementById("edInterest").value="See Schedule",document.getElementById("edTotalPI").value=
"N/A"));return h}if(document.getElementById("loan")){var e={},k={NORMAL:0,CANADIAN:1,FIXED_PRINCIPAL:2,INTEREST_ONLY:3,NO_INTEREST:4,RULE_OF_78S:5},g,l,c,D,Q=!1;a(document).ready(function(){g=new d.NE("edPV",d.moneyConventions,2);l=new d.NE("edNumPmts",d.numConventions,0);c=new d.NE("edRate",d.rateConventions,4);D=new d.NE("edPmt",d.moneyConventions,2);g.setValue(g.getUSNumber());l.setValue(l.getUSNumber());c.setValue(c.getUSNumber());D.setValue(D.getUSNumber());document.getElementById("edInterest").value=
d.formatLocalFloat(0,d.moneyConventions,2);document.getElementById("edTotalPI").value=d.formatLocalFloat(0,d.moneyConventions,2);a("#btnCalc").click(function(a){G();u()});a("#btnClear").click(function(a){g.setValue(0);l.setValue(0);c.setValue(0);D.setValue(0);document.getElementById("edInterest").value=d.formatLocalFloat(0,d.moneyConventions,2);document.getElementById("edTotalPI").value=d.formatLocalFloat(0,d.moneyConventions,2)});a("#btnPrint").click(function(a){Q=!0;G();u();d.print_calc();Q=!1});
a("#btnHelp").click(function(a){d.show_help()});a("#btnSchedule").click(function(a){var g;d.summary.cashFlowType=d.CASH_FLOW_TYPE.CF_DEBT;G();e.amortMthd===k.NO_INTEREST&&c.setValue(0);if(0===e.pv||0===e.n||0===e.cf||0===e.nominalRate&&e.amortMthd!==k.NO_INTEREST)g=u();d.showLoanSchedule(d.LOAN_SCHEDULE.calc(e,g))});a("#btnCharts").click(function(a){var g;d.summary.cashFlowType=d.CASH_FLOW_TYPE.CF_DEBT;G();e.amortMthd===k.NO_INTEREST&&c.setValue(0);if(0===e.pv||0===e.n||0===e.cf||0===e.nominalRate&&
e.amortMthd!==k.NO_INTEREST)g=u();d.showLoanCharts(d.LOAN_SCHEDULE.calc(e,g))});a("#CCY").click(function(a){GUI$.init_CURRENCYDATE_Dlg()})})}})(jQuery,GUI$);
